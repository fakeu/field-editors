{"version":3,"file":"field-editor-markdown.cjs.production.min.js","sources":["../src/components/MarkdownTabs.tsx","../src/components/icons.tsx","../src/components/HeadingSelector.tsx","../src/components/InsertLinkSelector.tsx","../src/components/MarkdownToolbar.tsx","../src/utils/userAgent.ts","../src/components/MarkdownTextarea/CodeMirrorWrapper.ts","../src/components/MarkdownTextarea/MarkdownCommands.ts","../src/components/MarkdownTextarea/MarkdownTextarea.tsx","../src/components/MarkdownTextarea/createMarkdownEditor.ts","../src/types.ts","../src/components/MarkdownBottomBar.tsx","../src/dialogs/CheatsheetModalDialog.tsx","../src/components/MarkdownPreview.tsx","../src/utils/replaceMailtoAmp.ts","../src/components/MarkdownConstraints.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/utils/isValidUrl.ts","../src/dialogs/InsertLinkModalDialog.tsx","../src/utils/specialCharacters.ts","../src/dialogs/SpecialCharacterModalDialog.tsx","../src/dialogs/InsertTableModalDialog.tsx","../src/dialogs/EmdebExternalContentDialog.tsx","../src/dialogs/ConfirmInsertAssetModalDialog.tsx","../src/dialogs/ZenModeModalDialog.tsx","../src/utils/insertAssetLinks.ts","../src/utils/linkOrganizer.ts","../src/MarkdownActions.ts","../src/MarkdownEditor.tsx","../src/dialogs/openMarkdownDialog.tsx","../src/dialogs/renderMarkdownDialog.tsx"],"sourcesContent":["import React from 'react';\nimport { css, cx } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownTab } from '../types';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    zIndex: 10,\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    overflow: 'hidden',\n    marginBottom: '-1px',\n    fontSize: tokens.fontSizeM,\n  }),\n  tab: css({\n    cursor: 'pointer',\n    color: tokens.gray700,\n    padding: tokens.spacingXs,\n    minWidth: '70px',\n    border: `1px solid ${tokens.gray400}`,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n    borderTopRightRadius: tokens.borderRadiusSmall,\n    marginLeft: tokens.spacingXs,\n    textAlign: 'center',\n    backgroundColor: tokens.gray100,\n    borderBottomColor: tokens.gray100,\n    outline: 'none',\n    '&:focus': {\n      boxShadow: tokens.boxShadowHeavy,\n    },\n    transition: `all ${tokens.transitionEasingDefault} ${tokens.transitionDurationShort}`,\n  }),\n  inactiveTab: css({\n    background: tokens.gray200,\n    borderBottomColor: tokens.gray400,\n    '&:hover': {\n      background: tokens.gray300,\n    },\n  }),\n};\n\ninterface MarkdownTabsProps {\n  active: MarkdownTab;\n  onSelect: (selected: MarkdownTab) => void;\n}\n\nfunction MarkdownTabItem(props: {\n  isActive: boolean;\n  name: MarkdownTab;\n  testId: string;\n  onSelect: (name: MarkdownTab) => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <div\n      className={cx(styles.tab, {\n        [styles.inactiveTab]: props.isActive === false,\n      })}\n      onClick={() => {\n        props.onSelect(props.name);\n      }}\n      onKeyDown={(e) => {\n        if (e.keyCode === 13) {\n          props.onSelect(props.name);\n        }\n      }}\n      tabIndex={0}\n      role=\"tab\"\n      aria-controls={props.name}\n      aria-selected={props.isActive === true}\n      data-test-id={props.testId}>\n      {props.children}\n    </div>\n  );\n}\n\nexport function MarkdownTabs(props: MarkdownTabsProps) {\n  return (\n    <div className={styles.root}>\n      <MarkdownTabItem\n        name=\"editor\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'editor'}\n        testId=\"markdown-tab-md\">\n        Editor\n      </MarkdownTabItem>\n      <MarkdownTabItem\n        name=\"preview\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'preview'}\n        testId=\"markdown-tab-preview\">\n        Preview\n      </MarkdownTabItem>\n    </div>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\n\ntype IconProps = {\n  width?: number;\n  height?: number;\n  className?: string;\n  label: string;\n};\n\nconst srOnly = css({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: '0',\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  border: '0',\n});\n\nexport const Zen = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Strikethrough = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Indent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Dedent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Cubes = ({ label, ...rest }: IconProps) => (\n  <svg width={18} height={14} viewBox=\"0 0 2304 1792\" {...rest}>\n    <path d=\"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Table = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const SpecialChar = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const OrgLinks = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Undo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Redo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\nimport { HeadingType } from '../types';\n\nexport const HeadingSelector = (props: {\n  children: React.ReactElement;\n  onSelect: (heading: HeadingType) => void;\n  tooltip?: string;\n}) => {\n  const handleMenuClick = (heading: HeadingType) => {\n    props.onSelect(heading);\n  };\n\n  return (\n    <Menu>\n      <Menu.Trigger>{props.children}</Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdown-action-button-heading-h1\" onClick={() => handleMenuClick('h1')}>\n          Heading 1\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h2\" onClick={() => handleMenuClick('h2')}>\n          Heading 2\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h3\" onClick={() => handleMenuClick('h3')}>\n          Heading 3\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\n\nimport { Button } from '@contentful/f36-components';\n\nimport { AssetIcon, ChevronDownIcon } from '@contentful/f36-icons';\n\ninterface InsertLinkSelectorProps {\n  onSelectExisting: Function;\n  onAddNew: Function;\n  canAddNew: boolean;\n  disabled: boolean;\n}\n\nexport const InsertLinkSelector = (props: InsertLinkSelectorProps) => {\n  if (props.canAddNew) {\n    return <MultipleMediaContextMenu {...props} />;\n  } else {\n    return (\n      <Button\n        isDisabled={props.disabled}\n        startIcon={<AssetIcon />}\n        testId=\"markdownEditor.linkExistingAssets\"\n        size=\"small\"\n        variant=\"secondary\"\n        onClick={() => {\n          props.onSelectExisting();\n        }}>\n        Insert media\n      </Button>\n    );\n  }\n};\n\nconst MultipleMediaContextMenu = (props: InsertLinkSelectorProps) => {\n  return (\n    <Menu placement=\"bottom-end\">\n      <Menu.Trigger>\n        <Button\n          endIcon={<ChevronDownIcon />}\n          isDisabled={props.disabled}\n          startIcon={<AssetIcon />}\n          testId=\"markdownEditor.insertMediaDropdownTrigger\"\n          size=\"small\"\n          variant=\"secondary\">\n          Insert media\n        </Button>\n      </Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdownEditor.uploadAssetsAndLink\" onClick={() => props.onAddNew()}>\n          Add new media and link\n        </Menu.Item>\n        <Menu.Item\n          testId=\"markdownEditor.linkExistingAssets\"\n          onClick={() => props.onSelectExisting()}>\n          Link existing media\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { css, cx } from 'emotion';\nimport { IconButton, Flex, Tooltip } from '@contentful/f36-components';\nimport type { ButtonProps } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  HeadingIcon,\n  FormatBoldIcon,\n  FormatItalicIcon,\n  QuoteIcon,\n  ListBulletedIcon,\n  ListNumberedIcon,\n  LinkIcon,\n  CodeIcon,\n  HorizontalRuleIcon,\n  MoreHorizontalIcon,\n} from '@contentful/f36-icons';\nimport * as Icons from './icons';\nimport { HeadingSelector } from './HeadingSelector';\nimport { InsertLinkSelector } from './InsertLinkSelector';\nimport { MarkdownActions } from '../types';\n\nconst styles = {\n  root: css({\n    position: 'relative',\n    zIndex: Number(tokens.zIndexWorkbenchHeader),\n    border: `1px solid ${tokens.gray400}`,\n    backgroundColor: tokens.gray100,\n    padding: tokens.spacingXs,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n  }),\n  button: css({\n    height: '30px',\n    width: '36px',\n    marginLeft: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  icon: css({\n    fill: tokens.gray700,\n    verticalAlign: 'middle',\n  }),\n  zenButton: css({\n    marginLeft: tokens.spacingXs,\n  }),\n  zenButtonPressed: css({\n    backgroundColor: tokens.gray400,\n  }),\n  tooltip: css({\n    zIndex: Number(tokens.zIndexTooltip),\n  }),\n};\n\nconst ToolbarButton = React.forwardRef<\n  HTMLButtonElement,\n  {\n    variant?: 'transparent' | 'secondary';\n    onClick?: Function;\n    tooltipPlace?: 'top' | 'bottom';\n    tooltip: string;\n    children: React.ReactElement;\n  } & Omit<ButtonProps, 'onClick'>\n>((props, ref) => {\n  const {\n    tooltip,\n    onClick,\n    children,\n    className,\n    variant = 'transparent',\n    tooltipPlace = 'top',\n    isDisabled = false,\n    ...otherProps\n  } = props;\n\n  return (\n    <Tooltip className={styles.tooltip} placement={tooltipPlace} content={tooltip}>\n      <IconButton\n        {...otherProps}\n        ref={ref}\n        className={cx(styles.button, className)}\n        isDisabled={isDisabled}\n        onClick={onClick as ButtonProps['onClick']}\n        variant={variant}\n        size=\"small\"\n        icon={children}\n        aria-label={tooltip}\n      />\n    </Tooltip>\n  );\n});\nToolbarButton.displayName = 'ToolbarButton';\n\ninterface MarkdownToolbarProps {\n  canUploadAssets: boolean;\n  disabled: boolean;\n  actions: MarkdownActions;\n  mode: 'default' | 'zen';\n}\n\nfunction MainButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n\n  return (\n    <>\n      <HeadingSelector\n        onSelect={(heading) => {\n          if (heading && props.actions.headings[heading]) {\n            props.actions.headings[heading]();\n          }\n        }}>\n        <ToolbarButton\n          isDisabled={props.disabled}\n          testId=\"markdown-action-button-heading\"\n          tooltip=\"Headings\"\n          tooltipPlace={tooltipPlace}>\n          <HeadingIcon aria-label=\"Headings\" className={styles.icon} />\n        </ToolbarButton>\n      </HeadingSelector>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-bold\"\n        tooltip=\"Bold\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.bold}>\n        <FormatBoldIcon aria-label=\"Bold\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-italic\"\n        tooltip=\"Italic\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.italic}>\n        <FormatItalicIcon aria-label=\"Italic\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-quote\"\n        tooltip=\"Quote\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.quote}>\n        <QuoteIcon aria-label=\"Quote\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ul\"\n        tooltip=\"Unordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ul}>\n        <ListBulletedIcon aria-label=\"Unordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ol\"\n        tooltip=\"Ordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ol}>\n        <ListNumberedIcon aria-label=\"Ordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-link\"\n        tooltip=\"Link\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertLink}>\n        <LinkIcon aria-label=\"Link\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nfunction AdditionalButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n  return (\n    <>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-strike\"\n        tooltip=\"Strike out\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.strike}>\n        <Icons.Strikethrough label=\"Strike out\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-code\"\n        tooltip=\"Code block\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.code}>\n        <CodeIcon aria-label=\"Code block\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-hr\"\n        tooltip=\"Horizontal rule\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.hr}>\n        <HorizontalRuleIcon aria-label=\"Horizontal rule\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-indent\"\n        tooltip=\"Increase indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.indent}>\n        <Icons.Indent label=\"Increase indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-dedent\"\n        tooltip=\"Decrease indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.dedent}>\n        <Icons.Dedent label=\"Decrease indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-embed\"\n        tooltip=\"Embed external content\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.embedExternalContent}>\n        <Icons.Cubes label=\"Embed external content\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-table\"\n        tooltip=\"Insert table\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertTable}>\n        <Icons.Table label=\"Insert table\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-special\"\n        tooltip=\"Insert special character\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertSpecialCharacter}>\n        <Icons.SpecialChar label=\"Insert special character\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-organizeLinks\"\n        tooltip=\"Organize links\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.organizeLinks}>\n        <Icons.OrgLinks label=\"Organize links\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-undo\"\n        tooltip=\"Undo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.undo}>\n        <Icons.Undo label=\"Undo\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-redo\"\n        tooltip=\"Redo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.redo}>\n        <Icons.Redo label=\"Redo\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nexport function DefaultMarkdownToolbar(props: MarkdownToolbarProps) {\n  const [showAdditional, setShowAdditional] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-toggle-additional\"\n            tooltip={showAdditional ? 'Hide additional actions' : 'More actions'}\n            onClick={() => {\n              setShowAdditional(!showAdditional);\n            }}>\n            <MoreHorizontalIcon className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-zen\"\n            variant=\"secondary\"\n            onClick={props.actions.openZenMode}\n            className={styles.zenButton}\n            tooltip=\"Expand\">\n            <Icons.Zen label=\"Expand\" className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n      </Flex>\n      {showAdditional && (\n        <Flex justifyContent=\"space-between\" marginTop=\"spacingXs\">\n          <Flex>\n            <AdditionalButtons {...props} />\n          </Flex>\n        </Flex>\n      )}\n    </div>\n  );\n}\n\nexport function ZenMarkdownToolbar(props: MarkdownToolbarProps) {\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <AdditionalButtons {...props} />\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <IconButton\n            testId=\"markdown-action-button-zen-close\"\n            variant=\"secondary\"\n            size=\"small\"\n            className={cx(styles.zenButton, styles.zenButtonPressed)}\n            onClick={() => {\n              props.actions.closeZenMode();\n            }}\n            icon={<Icons.Zen label=\"Collapse\" className={styles.icon} />}\n            aria-label=\"Collapse\"\n          />\n        </Flex>\n      </Flex>\n    </div>\n  );\n}\n\nexport const MarkdownToolbar = React.memo((props: MarkdownToolbarProps) => {\n  if (props.mode === 'zen') {\n    return <ZenMarkdownToolbar {...props} />;\n  }\n  return <DefaultMarkdownToolbar {...props} />;\n});\n\nMarkdownToolbar.displayName = 'MarkdownToolbar';\n","import get from 'lodash/get';\n\nconst userAgent = get(window, 'navigator.userAgent', '');\nconst platform = get(window, 'navigator.platform', '');\n\nlet ctrlKey = 'Ctrl';\n\nconst tests = {\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-ts-comment\n  // @ts-ignore ignore missing MSStream\n  ios: /(iphone os|ipad|iphone|ipod)/i.test(userAgent) && !window.MSStream,\n};\n\nif (tests.ios || /mac(68k|ppc|intel)/i.test(platform)) {\n  ctrlKey = 'Cmd';\n}\n\nexport function getCtrlKey() {\n  return ctrlKey;\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/addon/edit/matchbrackets';\nimport throttle from 'lodash/throttle';\nimport transform from 'lodash/transform';\n\nimport { EditorDirection } from '../../types';\nimport * as userAgent from '../../utils/userAgent';\n\nfunction stripUnit(value: number | string): number {\n  if (typeof value !== 'string') return value;\n\n  const cssRegex = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/;\n  const matchedValue = value.match(cssRegex);\n\n  if (!matchedValue) {\n    throw new Error(\"Couldn't match unit in given string\");\n  }\n\n  return parseFloat(value);\n}\n\nexport function create(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const { direction, fixedHeight, height, readOnly } = options || {};\n\n  // Set to true if `setValue()` has been called. This is to prevent\n  // undoing the initial content.\n  let initializedWithValue = false;\n\n  const LF = '\\n';\n\n  const EDITOR_SIZE = {\n    min: height ? stripUnit(height) : 300,\n    max: 500,\n    shift: 50,\n  };\n\n  const cm = CodeMirror(host, {\n    direction,\n    readOnly,\n    mode: 'markdown',\n    lineNumbers: false,\n    undoDepth: 200,\n    matchBrackets: true,\n    lineWrapping: true,\n    // When `lineSeparator === null` the document will be split\n    // on CRLFs as well as lone CRs and LFs. A single LF will\n    // be used as line separator in all output\n    lineSeparator: null,\n    theme: 'elegant',\n    tabSize: 2,\n    indentWithTabs: false,\n    indentUnit: 2,\n    autoRefresh: true,\n    spellcheck: true,\n    inputStyle: 'contenteditable',\n  });\n\n  cm.setSize('100%', EDITOR_SIZE.min);\n\n  if (!fixedHeight) {\n    cm.on('change', throttle(assureHeight, 150));\n  }\n\n  cm.setOption('extraKeys', {\n    Tab: function () {\n      replaceSelectedText(getIndentation());\n    },\n    Enter: 'newlineAndIndentContinueMarkdownList',\n    Esc: () => {\n      cm.getInputField().blur();\n    },\n  });\n\n  /**\n   * @description\n   * Custom API for a CodeMirror instance.\n   *\n   * An instance wraps a CodeMirror instance and provides a custom interface\n   * on top of CodeMirror.\n   */\n  return {\n    destroy,\n    disable,\n    enable,\n    attachEvent,\n    addKeyShortcuts,\n    setValue,\n    cmd,\n    moveToLineBeginning,\n    moveIfNotEmpty,\n    restoreCursor,\n    moveToLineEnd,\n    usePrimarySelection,\n    focus,\n    select,\n    selectBackwards,\n    selectAll: () => cm.execCommand('selectAll'),\n    extendSelectionBy,\n    insertAtCursor,\n    insertAtLineBeginning,\n    wrapSelection,\n    removeFromLineBeginning,\n    removeSelectedText,\n    replaceSelectedText,\n    getCursor,\n    setCursor,\n    getSelection,\n    getLine,\n    isLineEmpty,\n    getSelectedText,\n    getSelectionLength,\n    getCurrentLine,\n    getCurrentLineNumber,\n    getCurrentCharacter,\n    getCurrentLineLength,\n    lineStartsWith,\n    getIndentation,\n    getNl,\n    getValue,\n    getLinesCount,\n    getHistorySize,\n    setReadOnly: (value: boolean) => cm.setOption('readOnly', value),\n    getHistory: () => cm.getHistory(),\n    setHistory: (history: any) => cm.setHistory(history),\n    setFullsize: () => {\n      cm.setSize('100%', '100%');\n      cm.refresh();\n    },\n    refresh: () => cm.refresh(),\n  };\n\n  function destroy() {\n    // @ts-expect-error\n    cm.toTextArea();\n  }\n\n  function disable() {\n    cm.setOption('readOnly', 'nocursor');\n  }\n\n  function enable() {\n    cm.setOption('readOnly', false);\n  }\n\n  function assureHeight() {\n    const current = cm.heightAtLine(cm.lastLine(), 'local') + EDITOR_SIZE.shift;\n    let next = current;\n    if (current < EDITOR_SIZE.min) {\n      next = EDITOR_SIZE.min;\n    }\n    if (current > EDITOR_SIZE.max) {\n      next = EDITOR_SIZE.max;\n    }\n    cm.setSize('100%', next);\n  }\n\n  function attachEvent(name: string, fn: Function, throttleInterval: number) {\n    if (throttleInterval) {\n      fn = throttle(fn as any, throttleInterval);\n    }\n    cm.on(name, fn as any);\n  }\n\n  function addKeyShortcuts(map: any) {\n    const ctrlKey = userAgent.getCtrlKey();\n    cm.addKeyMap(\n      transform(\n        map,\n        (acc, value, key) => {\n          // eslint-disable-next-line -- TODO: describe this disable\n          // @ts-ignore\n          acc[ctrlKey + '-' + key] = value;\n        },\n        {}\n      )\n    );\n  }\n\n  /**\n   * low-level editor manipulation functions\n   */\n\n  /**\n   * @description\n   * Sets the content of the editor while preserving the cursor\n   * position.\n   *\n   * If called for the first time it will not record the change in\n   * the history.\n   */\n  function setValue(value?: string) {\n    value = value || '';\n    if (getValue() === value) {\n      return;\n    }\n\n    // set value, but save cursor position first\n    // position will be restored, but w/o focus (third arg)\n    const line = getCurrentLineNumber();\n    const ch = getCurrentCharacter();\n    cm.setValue(value);\n    restoreCursor(ch, line, true);\n\n    // We do not want to record the initial population in the\n    // history. Otherwise it would always be possible to revert to\n    // the empty string.\n    if (!initializedWithValue) {\n      cm.clearHistory();\n      initializedWithValue = true;\n    }\n  }\n\n  function cmd(name: string) {\n    cm.execCommand(name);\n    cm.focus();\n  }\n\n  function moveToLineBeginning(lineNumber?: number) {\n    cm.setCursor({ line: defaultToCurrentLineNumber(lineNumber), ch: 0 });\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Insert a new line below the cursor and move to the beginning of\n   * that line.\n   *\n   * Only do this if the editor has content and we are not already on\n   * the last line.\n   *\n   * TODO rename this\n   */\n  function moveIfNotEmpty() {\n    if (getCurrentLineLength() < 1) {\n      return;\n    }\n\n    const next = getCurrentLineNumber() + 1;\n    if (cm.lastLine() < next) {\n      moveToLineEnd();\n      insertAtCursor(getNl());\n    }\n\n    moveToLineBeginning(next);\n  }\n\n  function restoreCursor(character: number, lineNumber?: number, noFocus?: boolean) {\n    cm.setCursor(defaultToCurrentLineNumber(lineNumber), character, {\n      scroll: !noFocus,\n    });\n    if (!noFocus) {\n      cm.focus();\n    }\n  }\n\n  function moveToLineEnd(lineNumber?: number) {\n    cm.setCursor({\n      line: defaultToCurrentLineNumber(lineNumber),\n      ch: getCurrentLineLength(),\n    });\n    cm.focus();\n  }\n\n  function defaultToCurrentLineNumber(lineNumber?: number) {\n    if (lineNumber === 0 || (lineNumber !== undefined && lineNumber > 0)) {\n      return lineNumber;\n    }\n    return getCurrentLineNumber();\n  }\n\n  function usePrimarySelection() {\n    cmd('singleSelection');\n  }\n\n  function focus() {\n    cm.focus();\n  }\n\n  function select(from: CodeMirror.Position, to: CodeMirror.Position) {\n    cm.setSelection(from, to);\n    cm.focus();\n  }\n\n  function selectBackwards(skip: number, len: number) {\n    select(getPos(-skip - len), getPos(-skip));\n\n    function getPos(modifier: number) {\n      return {\n        line: getCurrentLineNumber(),\n        ch: getCurrentCharacter() + modifier,\n      };\n    }\n  }\n\n  function extendSelectionBy(modifier: number) {\n    select(getPos('anchor', 0), getPos('head', modifier));\n\n    function getPos(prop: 'anchor' | 'head', modifier: number): CodeMirror.Position {\n      const selection = getSelection();\n      if (!selection) {\n        return { line: 0, ch: 0 };\n      }\n      return { line: selection[prop].line, ch: selection[prop].ch + modifier };\n    }\n  }\n\n  function insertAtCursor(text: string) {\n    cm.replaceRange(text, cm.getCursor());\n    cm.focus();\n  }\n\n  function insertAtLineBeginning(text: string) {\n    const initialCh = getCurrentCharacter();\n    moveToLineBeginning();\n    insertAtCursor(text);\n    restoreCursor(initialCh + text.length);\n    cm.focus();\n  }\n\n  function wrapSelection(wrapper: string) {\n    const replacement = wrapper + getSelectedText() + wrapper;\n    const selection = getSelection();\n    if (selection) {\n      cm.replaceRange(replacement, selection.anchor, selection?.head);\n      cm.focus();\n    }\n  }\n\n  function removeFromLineBeginning(charCount: number) {\n    const lineNumber = getCurrentLineNumber();\n    cm.replaceRange('', { line: lineNumber, ch: 0 }, { line: lineNumber, ch: charCount });\n    cm.focus();\n  }\n\n  function removeSelectedText() {\n    cm.replaceSelection('');\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Replace the selected text with the given string.\n   *\n   * If nothing is selected it will insert the text at the current\n   * cursor position\n   *\n   * The optional `select` parameter controls what will be selected\n   * afters wards. By default the cursor will be at the end of the\n   * inserted text. You can pass 'around' to select the inserted\n   * text.\n   */\n  function replaceSelectedText(replacement: string, select?: string) {\n    cm.replaceSelection(replacement, select);\n    cm.focus();\n  }\n\n  /**\n   *  low-level editor get/check functions\n   */\n\n  function getCursor() {\n    return cm.getCursor();\n  }\n\n  function setCursor(cursor: number | CodeMirror.Position) {\n    cm.setCursor(cursor);\n  }\n\n  function getSelection() {\n    const selections = cm.listSelections();\n    if (!cm.somethingSelected() || !selections || selections.length < 1) {\n      return null;\n    }\n    return selections[0];\n  }\n\n  function getLine(lineNumber: number) {\n    return cm.getLine(lineNumber) || '';\n  }\n\n  function isLineEmpty(lineNumber?: number) {\n    const n = defaultToCurrentLineNumber(lineNumber);\n    return n > -1 && getLine(n).length < 1 && n < cm.lineCount();\n  }\n\n  function getLinesCount() {\n    return cm.lineCount();\n  }\n\n  function getSelectedText() {\n    return getSelection() ? cm.getSelection() : '';\n  }\n\n  function getSelectionLength() {\n    return getSelectedText().length;\n  }\n\n  function getCurrentLine() {\n    return getLine(getCurrentLineNumber());\n  }\n\n  function getCurrentLineNumber() {\n    return cm.getCursor().line;\n  }\n\n  function getCurrentCharacter() {\n    return cm.getCursor().ch;\n  }\n\n  function getCurrentLineLength() {\n    return getCurrentLine().length;\n  }\n\n  function lineStartsWith(text: string) {\n    return getCurrentLine().startsWith(text);\n  }\n\n  function getIndentation() {\n    return repeat(' ', cm.getOption('indentUnit') ?? 0);\n  }\n\n  function getNl(n = 1) {\n    if (n < 1) {\n      return '';\n    }\n    return repeat(LF, n);\n  }\n\n  function getValue() {\n    return cm.getValue() || '';\n  }\n\n  function getHistorySize(which?: 'undo' | 'redo') {\n    const history = cm.historySize();\n    return which ? history[which] : history;\n  }\n\n  function repeat(what: string, n: number) {\n    return new Array(n + 1).join(what);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport range from 'lodash/range';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport times from 'lodash/times';\n// eslint-disable-next-line -- TODO: describe this disable  you-dont-need-lodash-underscore/repeat\nimport repeat from 'lodash/repeat';\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\n\ntype EditorInstanceType = ReturnType<typeof CodeMirrorWrapper.create>;\n\nfunction createPrefixToggleFn(prefix: string) {\n  return (editor: EditorInstanceType) => {\n    if (editor.lineStartsWith(prefix)) {\n      editor.removeFromLineBeginning(prefix.length);\n    } else {\n      editor.insertAtLineBeginning(prefix);\n    }\n  };\n}\n\n/**\n * Wraps the current selection with a marker.\n *\n * If nothing is selected it inserts the given text wrapped in the\n * marker and selects the inner text\n *\n * Used b the `bold`, `italic`, and `strike` commands.\n */\nfunction wrapSelection(editor: EditorInstanceType, marker: string, emptyText: string) {\n  return () => {\n    editor.usePrimarySelection();\n\n    // there's a selection - wrap it with inline marker\n    if (editor.getSelection()) {\n      const selectedText = editor.getSelectedText();\n      if (selectedText.startsWith(marker) && selectedText.endsWith(marker)) {\n        const markerLength = marker.length;\n        const textWithoutMarker = selectedText.slice(\n          markerLength,\n          selectedText.length - markerLength\n        );\n        editor.replaceSelectedText(textWithoutMarker);\n      } else {\n        editor.wrapSelection(marker);\n      }\n    } else {\n      // no selection - insert sample text and select it\n      editor.insertAtCursor(marker + emptyText + marker);\n      editor.selectBackwards(marker.length, emptyText.length);\n    }\n  };\n}\n\nconst HEADER_CHAR = '#';\nconst quoteToggleFn = createPrefixToggleFn('> ');\nconst codeToggleFn = createPrefixToggleFn('    ');\n\n/**\n * @description\n * A collection of commands used by the user bound to a\n * CodeMirrorWrapper instance.\n *\n * The command collection only depends on the wrapper instance and is\n * used by UI from code mirror stuff.\n */\nexport function create(editor: EditorInstanceType) {\n  return {\n    bold: wrapSelection(editor, '__', 'text in bold'),\n    italic: wrapSelection(editor, '*', 'text in italic'),\n    strike: wrapSelection(editor, '~~', 'striked out'),\n    quote: modifySelection(editor, quoteToggleFn),\n    code: modifySelection(editor, codeToggleFn),\n    link,\n    h1: toggleHeader(editor, 1),\n    h2: toggleHeader(editor, 2),\n    h3: toggleHeader(editor, 3),\n    ul: modifySelection(editor, ulToggleFn, true),\n    ol: modifySelection(editor, olToggleFn, true),\n    undo: function () {\n      editor.cmd('undo');\n    },\n    redo: function () {\n      editor.cmd('redo');\n    },\n    hr,\n    indent,\n    dedent,\n    table,\n  };\n\n  /**\n   * @description\n   * Insert a line with `---` below the cursor.\n   */\n  function hr() {\n    editor.moveIfNotEmpty();\n    const nl = editor.getNl();\n    const markup = nl + '---' + nl + nl;\n    editor.insertAtCursor(markup);\n  }\n\n  /**\n   * @description\n   * Indent the current line.\n   */\n  function indent() {\n    editor.insertAtLineBeginning(editor.getIndentation());\n  }\n\n  /**\n   * @description\n   * Dedent the current line.\n   */\n  function dedent() {\n    const indentation = editor.getIndentation();\n    if (editor.lineStartsWith(indentation)) {\n      editor.removeFromLineBeginning(indentation.length);\n    }\n  }\n\n  /**\n   * @description\n   * Insert a markdown table template in a new line.\n   */\n  function table(config: { rows: number; cols: number }) {\n    const nl = editor.getNl();\n    editor.moveIfNotEmpty();\n    editor.insertAtCursor(nl);\n    const line = editor.getCurrentLineNumber();\n    editor.insertAtCursor(tableTemplate(config.rows, config.cols).join(nl));\n    editor.insertAtCursor(nl + nl);\n    editor.restoreCursor(2, line);\n  }\n\n  /**\n   * @description\n   * Inserts or replaces the current selection with a markdown link\n   */\n  function link(url: string, text?: string, title?: string) {\n    editor.usePrimarySelection();\n\n    const linkTitle = title ? ' \"' + title + '\"' : '';\n\n    const link = text ? '[' + text + '](' + url + linkTitle + ')' : '<' + url + '>';\n\n    editor.replaceSelectedText(link, 'around');\n  }\n}\n\n/**\n * For each line in the selection move to that line and call\n * `toggleFn` with the 1-based index of the line in the selection.\n *\n * If there is no selection we just call `toggleFn(editor)`.\n */\nfunction modifySelection(\n  editor: EditorInstanceType,\n  toggleFn: (editor: EditorInstanceType, listNumber?: number) => void,\n  isList?: boolean\n) {\n  return () => {\n    editor.usePrimarySelection();\n\n    const selection = editor.getSelection();\n    if (selection) {\n      // there's a selection - toggle list bullet for each line\n      // listNumber is 1, 2, 3... and can be used as ol bullet\n      forLineIn(selection, (lineNumber: number, listNumber: number) => {\n        // TODO move this into forLineIn\n        editor.moveToLineBeginning(lineNumber);\n        toggleFn(editor, listNumber);\n      });\n      editor.moveToLineEnd();\n    } else {\n      // there's no selection - just toggle line prefix\n      // but if adding list, add whitespace before and after list\n      if (isList && !getListNumber(editor) && !editor.lineStartsWith('- ')) {\n        prepareListWhitespace(editor);\n      }\n      toggleFn(editor);\n    }\n  };\n}\n\n/**\n * Calls callback for each line number that is in the selection\n *\n * The second argument is the 1-based index of the iteration.\n *\n * @param {CodeMirror.Selection} selection\n * param {function(number)} cb\n */\nfunction forLineIn(\n  selection: {\n    anchor: CodeMirror.Position;\n    head: CodeMirror.Position;\n  },\n  cb: Function\n) {\n  // anchor/head depend on selection direction, so min & max have to be used\n  const lines = [selection.anchor.line, selection.head.line];\n  const maxNumber = max(lines);\n  const minNumber = min(lines);\n  const lineRange = range(minNumber || 0, maxNumber !== undefined ? maxNumber + 1 : undefined);\n\n  lineRange.forEach((lineNumber, i) => {\n    cb(lineNumber, i + 1);\n  });\n}\n\nfunction prepareListWhitespace(editor: EditorInstanceType) {\n  const line = editor.getCurrentLineNumber();\n\n  const isCurrentLineEmpty = editor.isLineEmpty(line);\n\n  const isPrevLineEmpty = line > 0 ? editor.isLineEmpty(line - 1) : false;\n  const isNextLineEmpty = line < editor.getLinesCount() - 1 ? editor.isLineEmpty(line + 1) : true;\n\n  let linesToInsert = isCurrentLineEmpty ? 2 : 4;\n  if (isPrevLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n  if (isNextLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n\n  editor.moveToLineEnd();\n  editor.insertAtCursor(editor.getNl(linesToInsert));\n  editor.restoreCursor(0, isCurrentLineEmpty ? line : line + 2);\n}\n\nfunction getListNumber(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^(\\d+\\. )/);\n  return result ? result[1] : null;\n}\n\nfunction ulToggleFn(editor: EditorInstanceType) {\n  if (editor.lineStartsWith('- ')) {\n    editor.removeFromLineBeginning(2);\n  } else {\n    const listNumber = getListNumber(editor);\n    if (listNumber) {\n      editor.removeFromLineBeginning(listNumber.length);\n    }\n    editor.insertAtLineBeginning('- ');\n  }\n}\n\nfunction olToggleFn(editor: EditorInstanceType, n?: number) {\n  const listNumber = getListNumber(editor);\n  if (listNumber) {\n    editor.removeFromLineBeginning(listNumber.length);\n  } else {\n    if (editor.lineStartsWith('- ')) {\n      editor.removeFromLineBeginning(2);\n    }\n    editor.insertAtLineBeginning((n || 1) + '. ');\n  }\n}\n\n/**\n * From a table layout specification build a Markdown table template.\n *\n * Returns the lines as an array.\n * Used by the `table()` command\n *\n * @param {object} config\n * @param {number} rows\n * @param {number} cols\n * @returns {string[]}\n */\nfunction tableTemplate(nrows: number, ncols: number) {\n  const cellWidth = new Array(11);\n  const cell = ' ' + cellWidth.join(' ') + ' |';\n  const separatorCell = ' ' + cellWidth.join('-') + ' |';\n\n  let baseRow = '|';\n  let separatorRow = '|';\n\n  times(ncols, () => {\n    baseRow += cell;\n    separatorRow += separatorCell;\n  });\n\n  const bodyRows = range(nrows).map(() => baseRow.replace(/\\| {5}/g, '| Cell'));\n\n  const headerRow = baseRow.replace(/\\| {7}/g, '| Header');\n\n  return [headerRow, separatorRow].concat(bodyRows);\n}\n\n/**\n * Toggles the header prefix for a given level on the current line.\n *\n * - Removes a header when one of the same level is\n * - Replaces the header if there is one of a different level\n * - Otherwise inserts the header\n */\nfunction toggleHeader(editor: EditorInstanceType, level: number) {\n  return () => {\n    const initialCh = editor.getCurrentCharacter();\n    const currentHeader = selectHeader(editor);\n    const prefix = repeat(HEADER_CHAR, level);\n\n    // there's no header at the current line - create one\n    if (!currentHeader) {\n      editor.moveToLineBeginning();\n      editor.insertAtCursor(prefix + ' ');\n      editor.restoreCursor(initialCh + prefix.length + 1);\n      return;\n    }\n\n    // there's exactly the same header - remove one\n    if (editor.getSelectedText() === prefix) {\n      editor.extendSelectionBy(1);\n      const removedCh = editor.getSelectionLength();\n      editor.removeSelectedText();\n      editor.restoreCursor(initialCh - removedCh);\n      return;\n    }\n\n    // there's another header at the current line - replace\n    const diff = prefix.length - editor.getSelectionLength();\n    editor.replaceSelectedText(prefix);\n    editor.restoreCursor(initialCh + diff);\n  };\n}\n\n/**\n * On the current line select a Markdown header prefix. That is the\n * string at the beginning of the line that consists of up to six `#`.\n *\n * If the selection was successful return the selected string.\n */\nfunction selectHeader(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^( {0,3})(#{1,6}) /);\n  if (!result) {\n    return null;\n  }\n  const indentation = result[1];\n  const header = result[2];\n\n  editor.select(getPos(0), getPos(header.length));\n  return editor.getSelection();\n\n  function getPos(modifier: number) {\n    return {\n      line: editor.getCurrentLineNumber(),\n      ch: indentation.length + modifier,\n    };\n  }\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport tokens from '@contentful/f36-tokens';\nimport { css, cx } from 'emotion';\nimport { createMarkdownEditor } from './createMarkdownEditor';\nimport { EditorDirection } from '../../types';\n\nexport type InitializedEditorType = ReturnType<typeof createMarkdownEditor>;\n\ntype MarkdownTextareaProps = {\n  /**\n   * Minimum height to set for the markdown text area\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  disabled: boolean;\n  visible: boolean;\n  onReady: (editor: InitializedEditorType) => void;\n};\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ${tokens.lineHeightDefault};\n    }\n    .CodeMirror-lines {\n      color: ${tokens.gray700};\n      padding: ${tokens.spacingL};\n    }\n    .CodeMirror-code {\n      font-family: ${tokens.fontStackMonospace};\n      font-size: ${tokens.fontSizeM};\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ${tokens.gray900};\n    }\n    span.cm-variable-2 {\n      color: ${tokens.gray700};\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ${tokens.red600};\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ${tokens.gray600};\n    }\n    span.cm-link,\n    span.cm-url {\n      color: ${tokens.blue500} !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  `,\n  framed: css({\n    '.CodeMirror': {\n      maxHeight: '500px',\n    },\n  }),\n  zen: css({\n    border: 'none !important',\n    '.CodeMirror-lines': {\n      maxWidth: '650px',\n      margin: '0 auto',\n    },\n  }),\n  disabled: css`\n    .CodeMirror {\n      background: ${tokens.gray100};\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  `,\n};\n\nexport const MarkdownTextarea = React.memo((props: MarkdownTextareaProps) => {\n  const hostRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<InitializedEditorType | null>(null);\n\n  useEffect(() => {\n    if (hostRef.current) {\n      setEditor(\n        createMarkdownEditor(\n          hostRef.current,\n          Object.assign(\n            {},\n            {\n              direction: props.direction,\n              readOnly: true,\n            },\n            props.mode === 'zen'\n              ? {\n                  fixedHeight: true,\n                  height: '100%',\n                }\n              : {},\n            props.minHeight !== undefined ? { height: props.minHeight } : {}\n          )\n        )\n      );\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  useEffect(() => {\n    if (editor) {\n      props.onReady(editor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.disabled && styles.disabled\n  );\n\n  return (\n    <div\n      className={className}\n      ref={hostRef}\n      data-test-id=\"markdown-textarea\"\n      style={{ display: props.visible ? 'block' : 'none' }}\n    />\n  );\n});\n\nMarkdownTextarea.displayName = 'MarkdownTextarea';\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\nimport * as Commands from './MarkdownCommands';\nimport { EditorDirection } from '../../types';\n\nexport function createMarkdownEditor(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const editor = CodeMirrorWrapper.create(host, options);\n\n  function wrapChange(fn: Function) {\n    return (e: any, ch: any) => {\n      fn(editor.getValue(), e, ch);\n    };\n  }\n\n  const api = {\n    actions: Commands.create(editor),\n    history: {\n      hasUndo: function () {\n        return editor.getHistorySize('undo') > 0;\n      },\n      hasRedo: function () {\n        return editor.getHistorySize('redo') > 0;\n      },\n    },\n    events: {\n      onScroll: function (fn: Function) {\n        editor.attachEvent('scroll', fn, 150);\n      },\n      onChange: function (fn: Function) {\n        editor.attachEvent('change', wrapChange(fn), 0);\n      },\n      onPaste: function (fn: Function) {\n        editor.attachEvent('paste', fn, 0);\n      },\n    },\n    insert: editor.insertAtCursor,\n    focus: editor.focus,\n    getContent: editor.getValue,\n    destroy: editor.destroy,\n    setContent: editor.setValue,\n    getSelectedText: editor.getSelectedText,\n    usePrimarySelection: editor.usePrimarySelection,\n    setReadOnly: editor.setReadOnly,\n    selectBackwards: editor.selectBackwards,\n    getCursor: editor.getCursor,\n    setCursor: editor.setCursor,\n    clear: () => editor.setValue(''),\n    selectAll: editor.selectAll,\n    setFullsize: editor.setFullsize,\n    refresh: editor.refresh,\n  };\n\n  editor.addKeyShortcuts({\n    B: api.actions.bold,\n    I: api.actions.italic,\n  });\n\n  return api;\n}\n","export type MarkdownTab = 'editor' | 'preview';\n\nexport type HeadingType = 'h1' | 'h2' | 'h3';\n\nexport type EditorDirection = 'ltr' | 'rtl';\n\nexport enum MarkdownDialogType {\n  cheatsheet = 'markdown-cheatsheet',\n  insertLink = 'markdown-insertLink',\n  insertSpecialCharacter = 'markdown-insertSpecialCharacter',\n  insertTable = 'markdown-insertTable',\n  embedExternalContent = 'markdown-embedExternalContent',\n  confirmInsertAsset = 'markdown-confirmInsertAsset',\n  zenMode = 'markdown-zenMode',\n}\n\nexport type MarkdownDialogsParams =\n  | {\n      type: MarkdownDialogType.zenMode;\n      initialValue: string;\n      locale: string;\n    }\n  | {\n      type: MarkdownDialogType.cheatsheet;\n    }\n  | {\n      type: MarkdownDialogType.insertLink;\n      selectedText?: string;\n    }\n  | {\n      type: MarkdownDialogType.insertSpecialCharacter;\n    }\n  | {\n      type: MarkdownDialogType.insertTable;\n    }\n  | {\n      type: MarkdownDialogType.embedExternalContent;\n    }\n  | {\n      type: MarkdownDialogType.confirmInsertAsset;\n      locale: string;\n      assets: Array<{\n        title: string;\n        description: string;\n        thumbnailUrl: string;\n        thumbnailAltText: string;\n      }>;\n    };\n\nexport type MarkdownActions = {\n  simple: {\n    bold: Function;\n    italic: Function;\n    quote: Function;\n    ol: Function;\n    ul: Function;\n    strike: Function;\n    code: Function;\n    hr: Function;\n    indent: Function;\n    dedent: Function;\n  };\n  headings: {\n    h1: Function;\n    h2: Function;\n    h3: Function;\n  };\n  history: {\n    undo: Function;\n    redo: Function;\n  };\n  insertLink: Function;\n  embedExternalContent: Function;\n  insertTable: Function;\n  insertSpecialCharacter: Function;\n  linkExistingMedia: Function;\n  addNewMedia: Function;\n  organizeLinks: Function;\n  openZenMode: Function;\n  closeZenMode: Function;\n};\n\nexport type PreviewComponents = {\n  embedly?: React.ComponentType<{ url: string }>;\n};\n","import React from 'react';\n\nimport { TextLink, Paragraph } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { css } from 'emotion';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    background: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    borderBottomLeftRadius: tokens.borderRadiusSmall,\n    borderBottomRightRadius: tokens.borderRadiusSmall,\n    padding: `${tokens.spacingXs} ${tokens.spacingS}`,\n  }),\n  help: css({\n    color: tokens.gray700,\n    fontSize: tokens.fontSizeS,\n    button: {\n      fontSize: tokens.fontSizeS,\n      lineHeight: 'inherit',\n    },\n  }),\n};\n\nexport function MarkdownCounter(props: { words: number; characters: number }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      {props.words} {props.words !== 1 ? 'words' : 'word'}, {props.characters}{' '}\n      {props.characters !== 1 ? 'characters' : 'character'}\n    </Paragraph>\n  );\n}\n\nexport function MarkdownHelp(props: { onClick: () => void }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      Format your text like a pro with the{' '}\n      <TextLink\n        as=\"button\"\n        testId=\"open-markdown-cheatsheet-button\"\n        onClick={() => {\n          props.onClick();\n        }}\n      >\n        markdown cheatsheet\n      </TextLink>\n      .\n    </Paragraph>\n  );\n}\n\nexport function MarkdownBottomBar(props: { children: React.ReactNode }) {\n  return <div className={styles.root}>{props.children}</div>;\n}\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { ModalContent } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nimport { TextLink, Heading } from '@contentful/f36-components';\n\nconst styles = {\n  flexColumnContainer: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n  }),\n  flexColumn: css({\n    flexGrow: 1,\n  }),\n  verticalDivider: css({\n    borderRight: `1px solid ${tokens.gray500}`,\n    paddingRight: tokens.spacing3Xl,\n    marginRight: tokens.spacing2Xl,\n  }),\n  preview: css({\n    display: 'inline-block',\n    paddingRight: tokens.spacingL,\n    width: '50%',\n  }),\n  unOrderedListPreview: css({\n    listStyleType: 'disc',\n    marginLeft: tokens.spacingS,\n  }),\n  orderedListPreview: css({\n    listStyleType: 'decimal',\n    marginLeft: tokens.spacingS,\n  }),\n  markup: css({\n    display: 'inline-block',\n    color: tokens.gray600,\n    paddingLeft: tokens.spacingL,\n    width: '50%',\n  }),\n  h1: css({\n    fontSize: tokens.fontSize2Xl,\n  }),\n  h2: css({\n    fontSize: tokens.fontSizeXl,\n  }),\n  h3: css({\n    fontSize: tokens.fontSizeL,\n  }),\n  helpItem: css({\n    marginBottom: tokens.spacingS,\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: tokens.spacingXl,\n  }),\n  helpLink: css({\n    margin: 'auto',\n  }),\n  flexRowContainer: css({\n    display: 'flex',\n    width: '100%',\n    justifyContent: 'center',\n    marginTop: tokens.spacingXl,\n  }),\n};\n\nexport const CheatsheetModalDialog = () => {\n  return (\n    <ModalContent testId=\"markdown-cheatsheet-dialog-content\">\n      <div className={styles.flexColumnContainer}>\n        <div className={cx(styles.flexColumn, styles.verticalDivider)}>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h1\" className={cx(styles.preview, styles.h1)}>\n              H1\n            </Heading>\n            <div className={styles.markup}># heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h2\" className={cx(styles.preview, styles.h2)}>\n              H2\n            </Heading>\n            <div className={styles.markup}>## heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h3\" className={cx(styles.preview, styles.h3)}>\n              H3\n            </Heading>\n            <div className={styles.markup}>### heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <strong className={styles.preview}>bold</strong>\n            <div className={styles.markup}>__text__</div>\n          </div>\n          <div className={styles.helpItem}>\n            <em className={styles.preview}>italic</em>\n            <div className={styles.markup}>*text*</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>strikethrough</div>\n            <div className={styles.markup}>~~text~~</div>\n          </div>\n          <div className={styles.helpItem}>\n            <TextLink as=\"button\" className={styles.preview}>\n              Link\n            </TextLink>\n            <div className={styles.markup}>[text](url)</div>\n          </div>\n        </div>\n        <div className={styles.flexColumn}>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Image</div>\n            <div className={styles.markup}>![alt-text](url)</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Unordered list</div>\n            <div className={styles.markup}>* list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Ordered list</div>\n            </div>\n            <div className={styles.markup}>1. list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Blockquote</div>\n            </div>\n            <div className={styles.markup}>&gt; quote</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code span</div>\n            <div className={styles.markup}>`code here`</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code block</div>\n            <div className={styles.markup}>```code here```</div>\n          </div>\n        </div>\n      </div>\n      <div className={styles.flexRowContainer}>\n        <TextLink\n          className={styles.helpLink}\n          href=\"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\">\n          View the full GitHub-flavored Markdown syntax help (opens in a new window)\n        </TextLink>\n      </div>\n    </ModalContent>\n  );\n};\n\nexport const openCheatsheetModal = (dialogs: DialogsAPI): Promise<void> => {\n  return dialogs.openCurrent({\n    title: 'Markdown formatting help',\n    width: 'large',\n    minHeight: '415px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.cheatsheet,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\n\nimport tokens from '@contentful/f36-tokens';\nimport DOMPurify from 'dompurify';\nimport { css, cx } from 'emotion';\nimport Markdown from 'markdown-to-jsx';\n\nimport { EditorDirection, PreviewComponents } from '../types';\nimport { replaceMailtoAmp } from '../utils/replaceMailtoAmp';\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ${tokens.spacingL};\n    font-size: ${tokens.fontSizeM};\n    font-family: ${tokens.fontStackPrimary};\n    line-height: ${tokens.lineHeightDefault};\n    color: ${tokens.gray700};\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingM};\n      color: ${tokens.gray900};\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ${tokens.spacingM};\n    }\n\n    ul,\n    ol {\n      margin: ${tokens.spacingS} 0;\n      padding-left: ${tokens.spacingM};\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: ${tokens.spacingM} auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ${tokens.gray300};\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ${tokens.gray200};\n    }\n\n    table td {\n      border: 1px solid ${tokens.gray300};\n    }\n\n    a {\n      color: ${tokens.blue500};\n    }\n\n    hr {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingL};\n      height: 1px;\n      background-color: ${tokens.gray300};\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ${tokens.gray200};\n      padding-left: ${tokens.spacingL};\n      margin: 0;\n      margin-top: ${tokens.spacingM};\n      font-style: italic;\n    }\n\n    img {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ${tokens.fontSizeS};\n      font-family: ${tokens.fontStackMonospace};\n    }\n\n    .embedly-card {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n    }\n  `,\n  framed: css({\n    height: '100%',\n    maxHeight: '500px',\n    overflowY: 'auto',\n  }),\n  zen: css({\n    maxWidth: '650px',\n    margin: '0 auto',\n    border: 'none !important',\n  }),\n  rtl: css({\n    direction: 'rtl',\n  }),\n};\n\ntype MarkdownPreviewProps = {\n  /**\n   * Minimum height to set for the markdown preview\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  value: string;\n  previewComponents?: PreviewComponents;\n};\n\nfunction MarkdownLink(props: {\n  href: string;\n  title: string;\n  className?: string;\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n  children: any;\n  Embedly?: React.SFC<{ url: string }>;\n}) {\n  const { Embedly, children, ...rest } = props;\n\n  if (props.className === 'embedly-card' && Embedly) {\n    return <Embedly url={props.href} />;\n  }\n\n  return (\n    <a {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport const MarkdownPreview = React.memo((props: MarkdownPreviewProps) => {\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.direction === 'rtl' ? styles.rtl : undefined\n  );\n\n  // See the list of allowed Tags here:\n  // https://github.com/cure53/DOMPurify/blob/main/src/tags.js#L3-L121\n  const cleanHTML = React.useMemo(() => {\n    return replaceMailtoAmp(DOMPurify.sanitize(props.value));\n  }, [props.value]);\n\n  return (\n    <div className={className} data-test-id=\"markdown-preview\">\n      <Markdown\n        options={{\n          overrides: {\n            a: {\n              // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n              component: MarkdownLink as any,\n              props: {\n                Embedly: props.previewComponents?.embedly,\n              },\n            },\n          },\n        }}>\n        {cleanHTML}\n      </Markdown>\n    </div>\n  );\n});\n\nMarkdownPreview.displayName = 'MarkdownPreview';\n","// This code will replace '&amp;' with '&' only inside the href attribute of the mailto link.\n// Otherwise the mailto link will not work correctly\nexport const replaceMailtoAmp = (string: string) => {\n  return string.replace(/href=\"mailto:[^\"]*&amp;/g, function (match) {\n    return match.replace(/&amp;/g, '&');\n  });\n};\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { ConstraintsUtils, CharCounter, CharValidation } from '@contentful/field-editor-shared';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    fontSize: tokens.fontSizeM,\n    marginTop: tokens.spacingXs,\n    color: tokens.gray700,\n  }),\n};\n\nexport function MarkdownConstraints(props: { sdk: FieldExtensionSDK; value: string }) {\n  const constraints = ConstraintsUtils.fromFieldValidations(\n    props.sdk.field.validations,\n    props.sdk.field.type as 'Text'\n  );\n\n  const checkConstraint = ConstraintsUtils.makeChecker(constraints);\n\n  return (\n    <div className={styles.root}>\n      <CharCounter value={props.value} checkConstraint={checkConstraint} />\n      <CharValidation constraints={constraints} />\n    </div>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const urlRegex =\n  /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-/]))?$/;\n\nexport function isValidUrl(value: string) {\n  return urlRegex.test(value);\n}\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\ntype InsertLinkModalPositiveResult = { url: string; text: string; title: string };\nexport type InsertLinkModalResult = InsertLinkModalPositiveResult | false | undefined;\n\ntype InsertLinkModalProps = {\n  selectedText?: string;\n  onClose: (result: InsertLinkModalResult) => void;\n};\n\nexport const InsertLinkModal = ({ selectedText, onClose }: InsertLinkModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [text, setText] = useState(selectedText || '');\n  const [url, setUrl] = useState('');\n  const [touched, setTouched] = useState(false);\n  const [title, setTitle] = useState('');\n  const onInsert = (values: InsertLinkModalPositiveResult) => onClose(values);\n\n  const urlIsValid = isValidUrl(url);\n\n  useEffect(() => {\n    if (mainInputRef?.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-link-modal\">\n        <Form onSubmit={() => onInsert({ url, text, title })}>\n          <FormControl id=\"link-text-field\" isDisabled={Boolean(selectedText)}>\n            <FormControl.Label>Link text</FormControl.Label>\n            <TextInput\n              name=\"link-text\"\n              value={text}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setText(e.target.value);\n              }}\n              testId=\"link-text-field\"\n            />\n          </FormControl>\n\n          <FormControl id=\"target-url-field\" isInvalid={touched && !urlIsValid}>\n            <FormControl.Label>Target URL</FormControl.Label>\n            <TextInput\n              name=\"target-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setUrl(e.target.value);\n                setTouched(true);\n              }}\n              placeholder=\"https://\"\n              maxLength={2100}\n              testId=\"target-url-field\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {touched && !urlIsValid && (\n              <FormControl.ValidationMessage>Invalid URL</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"link-title-field\">\n            <FormControl.Label>Link title</FormControl.Label>\n            <TextInput\n              name=\"link-title\"\n              value={title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setTitle(e.target.value);\n              }}\n              testId=\"link-title-field\"\n            />\n            <FormControl.HelpText>\n              Extra link information, usually shown as a tooltip on mouse hover\n            </FormControl.HelpText>\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-link-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-link-confirm\"\n          onClick={() => {\n            onInsert({ url, text, title });\n          }}\n          isDisabled={!urlIsValid}\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertLinkDialog = (\n  dialogs: DialogsAPI,\n  params: { selectedText?: string }\n): Promise<InsertLinkModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert link',\n    width: 'large',\n    minHeight: '410px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertLink,\n      ...params,\n    } as MarkdownDialogsParams,\n  });\n};\n","export const specialCharacters = [\n  { code: 180, desc: 'acute accent' },\n  { code: 38, desc: 'ampersand' },\n  { code: 166, desc: 'broken vertical bar' },\n  { code: 8226, desc: 'bullet' },\n  { code: 184, desc: 'cedilla' },\n  { code: 162, desc: 'cent' },\n  { code: 169, desc: 'copyright' },\n  { code: 176, desc: 'degree' },\n  { code: 247, desc: 'division' },\n  { code: 189, desc: 'fraction half' },\n  { code: 188, desc: 'fraction quarter' },\n  { code: 190, desc: 'fraction three quarters' },\n  { code: 62, desc: 'greater than' },\n  { code: 161, desc: 'inverted exclamation mark' },\n  { code: 191, desc: 'inverted question mark' },\n  { code: 171, desc: 'left-pointing double angle quotation mark' },\n  { code: 60, desc: 'less than' },\n  { code: 175, desc: 'macron' },\n  { code: 181, desc: 'micro' },\n  { code: 160, desc: 'non-breaking space' },\n  { code: 172, desc: 'not' },\n  { code: 182, desc: 'paragraph' },\n  { code: 177, desc: 'plus-minus' },\n  { code: 34, desc: 'quotation mark' },\n  { code: 174, desc: 'registered' },\n  { code: 187, desc: 'right-pointing double angle quotation mark' },\n  { code: 167, desc: 'section' },\n  { code: 168, desc: 'umlaut/diaeresis' },\n  { code: 215, desc: 'multiplication' },\n  { code: 8482, desc: 'trade mark' },\n  { code: 8364, desc: 'euro' },\n  { code: 163, desc: 'pound' },\n  { code: 165, desc: 'yen' },\n  { code: 8222, desc: 'double low-9 quotation mark' },\n  { code: 710, desc: 'modifier circumflex accent' },\n  { code: 8224, desc: 'dagger' },\n  { code: 8225, desc: 'double dagger' },\n  { code: 8230, desc: 'horizontal ellipsis' },\n  { code: 8220, desc: 'left double quotation mark' },\n  { code: 8249, desc: 'single left-pointing angle quotation mark' },\n  { code: 8216, desc: 'left single quotation mark' },\n  { code: 183, desc: 'middle dot' },\n  { code: 8212, desc: 'em dash' },\n  { code: 8211, desc: 'en dash' },\n  { code: 8240, desc: 'per mille' },\n  { code: 8250, desc: 'single right-pointing angle quotation mark' },\n  { code: 8217, desc: 'right single quotation mark' },\n  { code: 8218, desc: 'single low-9 quotation mark' },\n  { code: 170, desc: 'feminine ordinal indicator' },\n  { code: 186, desc: 'masculine ordinal indicator' },\n  { code: 8221, desc: 'right double quotation mark' },\n  { code: 732, desc: 'small tilde' },\n  { code: 9829, desc: 'black heart' },\n  { code: 9830, desc: 'diamond' },\n];\n","import React, { useState } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  Flex,\n  Button,\n  Tooltip,\n} from '@contentful/f36-components';\nimport { specialCharacters } from '../utils/specialCharacters';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nconst styles = {\n  buttonPanel: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  charButton: css({\n    border: `1px solid ${tokens.gray500}`,\n    width: '4.1rem',\n    height: '4.1rem',\n    fontSize: tokens.fontSizeXl,\n    marginTop: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  selectedCharButton: css({\n    backgroundColor: tokens.gray100,\n  }),\n  tooltip: css({ zIndex: 1000 }),\n  button: css({\n    marginTop: tokens.spacingM,\n    marginRight: tokens.spacingS,\n  }),\n};\n\nexport type SpecialCharacterModalResult = string | false | undefined;\n\ntype SpecialCharacterModalDialogProps = {\n  onClose: (result: SpecialCharacterModalResult) => void;\n};\n\nexport const SpecialCharacterModalDialog = ({ onClose }: SpecialCharacterModalDialogProps) => {\n  const [selectedCharacter, setSelectedCharacter] = useState<{ code: number; desc: string }>(\n    specialCharacters[0]\n  );\n  return (\n    <>\n      <ModalContent testId=\"insert-special-character-modal\">\n        <Flex flexDirection=\"column\" alignItems=\"center\">\n          <Text as=\"div\" lineHeight=\"lineHeight3Xl\" fontSize=\"fontSize3Xl\" marginBottom=\"spacingS\">\n            {String.fromCharCode(selectedCharacter.code)}\n          </Text>\n          <Text as=\"div\" marginBottom=\"spacingS\">\n            {selectedCharacter.desc}\n          </Text>\n        </Flex>\n        <div className={styles.buttonPanel}>\n          {specialCharacters.map((char) => (\n            <div key={char.code}>\n              <Tooltip className={styles.tooltip} content={char.desc}>\n                <Button\n                  testId=\"special-character-button\"\n                  isActive={char.code === selectedCharacter.code}\n                  className={styles.charButton}\n                  variant=\"transparent\"\n                  onClick={() => setSelectedCharacter(char)}>\n                  {String.fromCharCode(char.code)}\n                </Button>\n              </Tooltip>\n            </div>\n          ))}\n        </div>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-character-cancel\"\n          className={styles.button}\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          className={styles.button}\n          testId=\"insert-character-confirm\"\n          onClick={() => onClose(String.fromCharCode(selectedCharacter.code))}\n          variant=\"positive\"\n          size=\"small\">\n          Insert selected\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertSpecialCharacter = (\n  dialogs: DialogsAPI\n): Promise<SpecialCharacterModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert special character',\n    width: 'large',\n    minHeight: '600px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertSpecialCharacter,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport inRange from 'lodash/inRange';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ntype InsertTableModalPositiveResult = { cols: number; rows: number };\nexport type InsertTableModalResult = InsertTableModalPositiveResult | false | undefined;\n\ntype InsertTableModalProps = {\n  onClose: (result: InsertTableModalResult) => void;\n};\n\nexport const InsertTableModal = ({ onClose }: InsertTableModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [rows, setRows] = useState(2);\n  const [cols, setColumns] = useState(1);\n  const rowsAreValid = inRange(rows, 2, 100);\n  const colsAreValid = inRange(cols, 1, 100);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-table-modal\">\n        <Form>\n          <FormControl id=\"insert-table-rows-number-field\" isRequired isInvalid={!rowsAreValid}>\n            <FormControl.Label>Number of rows</FormControl.Label>\n            <TextInput\n              name=\"rows\"\n              value={rows.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setRows(Number(e.target.value))}\n              testId=\"insert-table-rows-number-field\"\n              min={2}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n              ref={mainInputRef}\n            />\n            {!rowsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 2 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"insert-table-columns-number-field\" isRequired isInvalid={!colsAreValid}>\n            <FormControl.Label>Number of columns</FormControl.Label>\n            <TextInput\n              name=\"columns\"\n              value={cols.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setColumns(Number(e.target.value))\n              }\n              testId=\"insert-table-columns-number-field\"\n              min={1}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n            />\n            {!colsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 1 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-table-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-table-confirm\"\n          onClick={() => onClose({ rows, cols })}\n          variant=\"positive\"\n          size=\"small\"\n          isDisabled={!rowsAreValid || !colsAreValid}>\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertTableDialog = (dialogs: DialogsAPI): Promise<InsertTableModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert table',\n    width: 'medium',\n    minHeight: '260px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertTable,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  TextLink,\n  Button,\n  Checkbox,\n  Radio,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\nconst styles = {\n  widthFiledGroup: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    alignItems: 'flex-start',\n  }),\n  radioButtonGroup: css({\n    display: 'inline-flex',\n    alignItems: 'flex-start',\n    paddingTop: tokens.spacingXl,\n  }),\n  radioButton: css({\n    marginLeft: tokens.spacingM,\n  }),\n};\n\nexport type EmbedExternalContentModalResult = string | false | undefined;\n\ntype EmbedExternalContentModalProps = {\n  onClose: (result: EmbedExternalContentModalResult) => void;\n};\n\ntype Unit = 'percent' | 'px';\n\nconst makeEmbedlyLink = ({\n  url,\n  width,\n  selectedUnit,\n  attachSocial,\n}: {\n  url: string;\n  width: number;\n  selectedUnit: Unit;\n  attachSocial: boolean;\n}): string => {\n  const s = { percent: '%', px: 'px' };\n  return [\n    '<a href=\"' + url + '\" class=\"embedly-card\" ',\n    'data-card-width=\"' + width + s[selectedUnit] + '\" ',\n    'data-card-controls=\"' + (attachSocial ? '1' : '0') + '\"',\n    '>Embedded content: ' + url + '</a>',\n  ].join('');\n};\n\nconst isWidthValid = (width: number, unit: Unit) => (unit === 'percent' ? width <= 100 : true);\n\nexport const EmbedExternalContentModal = ({ onClose }: EmbedExternalContentModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [url, setUrl] = useState<string>('https://');\n  const [selectedUnit, setUnit] = useState<Unit>('percent');\n  const [urlIsValid, setUrlValidity] = useState<boolean>(true);\n  const [width, setWidth] = useState('100');\n  const [attachSocial, setAttachSocial] = useState(false);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"embed-external-dialog\">\n        <Form>\n          <FormControl id=\"external-link-url-field\" isRequired isInvalid={!urlIsValid}>\n            <FormControl.Label>Content URL</FormControl.Label>\n            <TextInput\n              name=\"external-link-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                const value = e.target.value;\n                setUrl(value);\n                setUrlValidity(isValidUrl(value));\n              }}\n              testId=\"external-link-url-field\"\n              placeholder=\"https://example.com\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {!urlIsValid && (\n              <FormControl.ValidationMessage>URL is invalid</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n          <TextLink href=\"http://embed.ly/providers\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Supported sources\n          </TextLink>\n          <div className={styles.widthFiledGroup}>\n            <FormControl\n              id=\"embedded-content-width\"\n              isRequired\n              isInvalid={!isWidthValid(Number(width), selectedUnit)}>\n              <FormControl.Label>Width</FormControl.Label>\n              <TextInput\n                value={width}\n                name=\"embedded-content-width\"\n                testId=\"embedded-content-width\"\n                type=\"number\"\n                width=\"small\"\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWidth(e.target.value)}\n              />\n              {!isWidthValid(Number(width), selectedUnit) && (\n                <FormControl.ValidationMessage>\n                  Should be equal or less then 100\n                </FormControl.ValidationMessage>\n              )}\n            </FormControl>\n\n            <div className={styles.radioButtonGroup}>\n              <Radio\n                id=\"unit-option-percent\"\n                value=\"percent\"\n                isChecked={selectedUnit === 'percent'}\n                onChange={() => setUnit('percent')}\n                className={styles.radioButton}>\n                percent\n              </Radio>\n              <Radio\n                id=\"unit-option-pixels\"\n                value=\"pixels\"\n                isChecked={selectedUnit === 'px'}\n                onChange={() => setUnit('px')}\n                className={styles.radioButton}>\n                pixels\n              </Radio>\n            </div>\n          </div>\n          <Checkbox\n            id=\"attach-social-checkbox\"\n            name=\"attach-social-checkbox\"\n            value=\"Yes\"\n            isChecked={attachSocial}\n            onChange={() => setAttachSocial(!attachSocial)}\n            testId=\"attach-social-checkbox\">\n            Attach social sharing links to this element\n          </Checkbox>\n          <Text as=\"p\" fontColor=\"gray500\" marginTop=\"spacingXs\">\n            To enable this embedded content in your application make sure to add the&nbsp;\n            <TextLink\n              href=\"http://embed.ly/docs/products/cards\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\">\n              Embedly&apos;s platform.js\n            </TextLink>\n            &nbsp;on your development environment\n          </Text>\n          {/* <EmbedlyPreview previewUrl={url} /> */}\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"emded-external-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"embed-external-confirm\"\n          onClick={() =>\n            onClose(makeEmbedlyLink({ url, width: Number(width), selectedUnit, attachSocial }))\n          }\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openEmbedExternalContentDialog = (\n  dialogs: DialogsAPI\n): Promise<EmbedExternalContentModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Embed external content',\n    width: 'large',\n    minHeight: '435px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.embedExternalContent,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport {\n  ModalContent,\n  ModalControls,\n  Paragraph,\n  Button,\n  EntityList,\n} from '@contentful/f36-components';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ninterface ConfirmInsertAssetModalDialogProps {\n  onClose: (result: boolean) => void;\n  assets: Array<{\n    title: string;\n    description: string;\n    thumbnailUrl: string;\n    thumbnailAltText: string;\n  }>;\n  locale: string;\n}\n\nexport const ConfirmInsertAssetModalDialog = ({\n  onClose,\n  assets,\n  locale,\n}: ConfirmInsertAssetModalDialogProps) => {\n  const localesNumber = assets.length;\n\n  return (\n    <>\n      <ModalContent testId=\"confirm-insert-asset\">\n        <Paragraph>\n          {localesNumber === 1\n            ? `Link asset with missing file for locale ${locale}`\n            : `Link assets with missing files for locale ${locale}`}\n        </Paragraph>\n        <Paragraph>\n          {localesNumber === 1\n            ? 'Do you want to link to the file in its fallback locale?'\n            : 'Do you want to link to the files in their fallback locales?'}\n        </Paragraph>\n        <EntityList>\n          {assets.map(({ title, description, thumbnailUrl, thumbnailAltText }) => (\n            <EntityList.Item\n              key={thumbnailUrl}\n              title={title}\n              thumbnailUrl={`${thumbnailUrl}?w=46&h=46&fit=thumb`}\n              thumbnailAltText={thumbnailAltText}\n              description={description}\n            />\n          ))}\n        </EntityList>\n      </ModalContent>\n      <ModalControls>\n        <Button onClick={() => onClose(false)} variant=\"secondary\" size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"confirm-insert-asset\"\n          onClick={() => onClose(true)}\n          variant=\"positive\"\n          size=\"small\">\n          Confirm\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openConfirmInsertAsset = (\n  dialogs: DialogsAPI,\n  options: {\n    locale: string;\n    assets: Array<{\n      title: string;\n      description: string;\n      thumbnailUrl: string;\n      thumbnailAltText: string;\n    }>;\n  }\n): Promise<boolean> => {\n  return dialogs.openCurrent({\n    title: 'Confirm using fallback assets',\n    width: 'medium',\n    minHeight: '270px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.confirmInsertAsset,\n      ...options,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI, DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams, PreviewComponents } from '../types';\nimport { InitializedEditorType } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownToolbar } from '../components/MarkdownToolbar';\nimport { MarkdownTextarea } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownPreview } from '../components/MarkdownPreview';\nimport { MarkdownBottomBar, MarkdownHelp } from '../components/MarkdownBottomBar';\nimport { createMarkdownActions } from '../MarkdownActions';\nimport { openCheatsheetModal } from '../dialogs/CheatsheetModalDialog';\nimport tokens from '@contentful/f36-tokens';\n\nimport { ChevronRightIcon, ChevronLeftIcon } from '@contentful/f36-icons';\n\nexport type ZenModeResult = {\n  value: string;\n  cursor?: {\n    ch: number;\n    line: number;\n  };\n};\n\ntype ZenModeDialogProps = {\n  saveValueToSDK: (value: string | null | undefined) => void;\n  onClose: (result: ZenModeResult) => void;\n  initialValue: string;\n  locale: string;\n  sdk: DialogExtensionSDK;\n  previewComponents?: PreviewComponents;\n};\n\nconst styles = {\n  root: css({\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n  }),\n  topSplit: css({\n    position: 'fixed',\n    top: 0,\n    height: '48px',\n    left: 0,\n    right: 0,\n  }),\n  bottomSplit: css({\n    position: 'fixed',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '36px',\n  }),\n  editorSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    left: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  editorSplitFullscreen: css({\n    left: 0,\n    right: 0,\n    width: '100%',\n  }),\n  previewSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    right: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  separator: css({\n    position: 'fixed',\n    top: '48px',\n    bottom: '36px',\n    width: '1px',\n    background: tokens.gray400,\n    left: '50%',\n  }),\n  button: css({\n    position: 'fixed',\n    cursor: 'pointer',\n    zIndex: 105,\n    top: '49%',\n    height: '30px',\n    backgroundColor: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    padding: 0,\n  }),\n  hideButton: css({\n    left: '50%',\n  }),\n  showButton: css({\n    right: 0,\n    borderRightWidth: 0,\n  }),\n  icon: css({\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const ZenModeModalDialog = (props: ZenModeDialogProps) => {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [showPreview, setShowPreview] = React.useState<boolean>(true);\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n\n  React.useEffect(() => {\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    props.sdk?.window?.updateHeight('100%' as any);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  // refresh editor right after dialog is opened to avoid disappearing effect\n  React.useEffect(() => {\n    setTimeout(() => {\n      editor?.setFullsize();\n      editor?.refresh();\n    }, 150);\n  }, [editor]);\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  actions.closeZenMode = () => {\n    props.onClose({\n      value: currentValue,\n      cursor: editor?.getCursor(),\n    });\n  };\n\n  const direction = props.sdk.locales.direction[props.locale] ?? 'ltr';\n\n  return (\n    <div className={styles.root} data-test-id=\"zen-mode-markdown-editor\">\n      <div className={styles.topSplit}>\n        <MarkdownToolbar mode=\"zen\" disabled={false} canUploadAssets={false} actions={actions} />\n      </div>\n\n      <div\n        className={cx(styles.editorSplit, {\n          [styles.editorSplitFullscreen]: showPreview === false,\n        })}>\n        <MarkdownTextarea\n          mode=\"zen\"\n          visible\n          disabled={false}\n          direction={direction}\n          onReady={(editor) => {\n            editor.setContent(props.initialValue ?? '');\n            editor.setReadOnly(false);\n            setEditor(editor);\n            editor.focus();\n            editor.events.onChange((value: string) => {\n              setCurrentValue(value);\n              props.saveValueToSDK(value);\n            });\n          }}\n        />\n      </div>\n      {showPreview && (\n        <div className={styles.previewSplit}>\n          <MarkdownPreview\n            direction={direction}\n            mode=\"zen\"\n            value={currentValue}\n            previewComponents={props.previewComponents}\n          />\n        </div>\n      )}\n      {showPreview && <div className={styles.separator} />}\n      {showPreview && (\n        <button\n          className={cx(styles.button, styles.hideButton)}\n          aria-label=\"Hide preview\"\n          onClick={() => {\n            setShowPreview(false);\n          }}>\n          <ChevronRightIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      {!showPreview && (\n        <button\n          className={cx(styles.button, styles.showButton)}\n          aria-label=\"Show preview\"\n          onClick={() => {\n            setShowPreview(true);\n          }}>\n          <ChevronLeftIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      <div className={styles.bottomSplit}>\n        <MarkdownBottomBar>\n          <MarkdownHelp\n            onClick={() => {\n              openCheatsheetModal(props.sdk.dialogs);\n            }}\n          />\n        </MarkdownBottomBar>\n      </div>\n    </div>\n  );\n};\n\nexport const openZenMode = (\n  dialogs: DialogsAPI,\n  options: { initialValue: string; locale: string }\n): Promise<ZenModeResult> => {\n  return dialogs.openCurrent({\n    width: 'zen' as any, // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    shouldCloseOnEscapePress: false,\n    minHeight: '100vh',\n    shouldCloseOnOverlayClick: false,\n    parameters: {\n      type: MarkdownDialogType.zenMode,\n      initialValue: options.initialValue,\n      locale: options.locale,\n    } as MarkdownDialogsParams,\n  });\n};\n","import get from 'lodash/get';\nimport isObject from 'lodash/isObject';\n\n// eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\ntype Asset = any;\n\ntype LinkWithMedia = {\n  title: string;\n  asset: Asset;\n  url: string;\n  isLocalized: boolean;\n  isFallback: boolean;\n  asMarkdown: string;\n};\n\ntype Locales = {\n  localeCode: string;\n  fallbackCode: string | undefined;\n  defaultLocaleCode: string;\n};\n\nfunction normalizeWhiteSpace(str: string) {\n  if (str) {\n    return str.trim().replace(/\\s{2,}/g, ' ');\n  } else {\n    return str;\n  }\n}\n\nfunction removeExtension(str: string) {\n  return str.replace(/\\.\\w+$/g, '');\n}\n\nfunction fileNameToTitle(str: string) {\n  return normalizeWhiteSpace(removeExtension(str).replace(/_/g, ' '));\n}\n\nexport function replaceAssetDomain(fileUrl: string) {\n  const assetDomainMap: Record<string, string> = {\n    images: 'images.ctfassets.net',\n    assets: 'assets.ctfassets.net',\n    downloads: 'downloads.ctfassets.net',\n    videos: 'videos.ctfassets.net',\n  };\n\n  return fileUrl.replace(/(images|assets|downloads|videos).contentful.com/, (_, p1) => {\n    return assetDomainMap[p1];\n  });\n}\n\nfunction makeAssetLink(\n  asset: Asset,\n  { localeCode, fallbackCode, defaultLocaleCode }: Locales\n): LinkWithMedia | null {\n  const localizedFile = get(asset, ['fields', 'file', localeCode]);\n  const fallbackFile = fallbackCode ? get(asset, ['fields', 'file', fallbackCode]) : null;\n  const defaultFile = get(asset, ['fields', 'file', defaultLocaleCode]);\n  const file:\n    | {\n        url: string;\n        fileName: string;\n      }\n    | undefined = localizedFile || fallbackFile || defaultFile;\n\n  if (isObject(file) && file.url) {\n    const title: string =\n      get(asset, ['fields', 'title', localeCode]) ||\n      get(asset, ['fields', 'title', fallbackCode || '']) ||\n      get(asset, ['fields', 'title', defaultLocaleCode]) ||\n      fileNameToTitle(file.fileName);\n\n    const fileUrl = replaceAssetDomain(file.url);\n\n    return {\n      title,\n      asset,\n      url: fileUrl,\n      // is normally localized and we should not warn about this file\n      isLocalized: Boolean(localizedFile),\n      // was fallback value used\n      // if it was not localized normally, and we did not used a fallback\n      // it means we used a default locale - we filter empty values\n      isFallback: Boolean(fallbackFile),\n      // todo: tranform using fromHostname\n      asMarkdown: `![${title}](${fileUrl})`,\n    };\n  } else {\n    return null;\n  }\n}\n\nexport async function insertAssetLinks(assets: Array<Asset>, locales: Locales) {\n  // check whether do we have some assets, which don't have\n  // a version in this field's locale\n  const otherLocales = assets.filter((asset) => {\n    return !get(asset, ['fields', 'file', locales.localeCode]);\n  });\n\n  const linksWithMeta = assets\n    .map((asset) => makeAssetLink(asset, locales))\n    // remove empty links\n    .filter((asset) => asset !== null) as LinkWithMedia[];\n\n  // if there have values from fallback/default locales, we need to\n  // provide user a warning so we show him modal\n  if (otherLocales.length > 0) {\n    const fallbackAssets = linksWithMeta\n      // we don't want to warn about normally localized files\n      .filter(({ isLocalized }) => !isLocalized)\n      .map(({ title, isFallback, asset }) => {\n        const code = isFallback ? locales.fallbackCode : locales.defaultLocaleCode;\n        return {\n          title,\n          thumbnailUrl: asset.fields.file[code as string].url,\n          thumbnailAltText: title,\n          description: isFallback ? `Fallback locale (${code})` : `Default locale (${code})`,\n          asset: asset,\n        };\n      });\n\n    return {\n      fallbacks: fallbackAssets,\n      links: linksWithMeta,\n    };\n  }\n  return {\n    links: linksWithMeta,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport extend from 'lodash/extend';\nimport isString from 'lodash/isString';\nimport isObject from 'lodash/isObject';\nimport max from 'lodash/max';\n// eslint-disable-next-line -- TODO: describe this disable\nimport isFinite from 'lodash/isFinite';\n// eslint-disable-next-line -- TODO: describe this disable\nimport forEach from 'lodash/forEach';\n\nfunction extractTitle(title: string) {\n  title = title || '';\n  title = title.replace(/^ *('|\"|\\()*/, '');\n  title = title.replace(/('|\"|\\))* *$/, '');\n  return title;\n}\n\nfunction head(text: string) {\n  return text.split(' ').shift();\n}\n\nfunction tail(text: string) {\n  const segments = text.split(' ');\n  segments.shift();\n  return segments.join(' ');\n}\n\nconst PROCESSORS = {\n  inline: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n  ref: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      id: match[2],\n    };\n  },\n  label: function (match: any) {\n    return {\n      match: match[0],\n      id: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n};\n\nconst REGEXS = {\n  inline: /\\[([^\\r\\n[\\]]+)]\\(([^\\r\\n)]+)\\)/,\n  ref: /\\[([^\\r\\n[\\]]+)] ?\\[([^\\r\\n[\\]]+)]/,\n  label: /^ {0,3}\\[([^\\r\\n[\\]]+)]:\\s+(.+)$/,\n};\nexport const findInline = makeFinder('inline');\nexport const findRefs = makeFinder('ref');\nexport const findLabels = makeFinder('label');\n\nexport function convertInlineToRef(text: string) {\n  let id = findMaxLabelId(text);\n\n  forEach(findInline(text), (inline) => {\n    id += 1;\n    text = text.replace(inline.match, buildRef(inline, id));\n    text += '\\n' + buildLabel(inline, id);\n  });\n\n  return text;\n}\n\nfunction mergeLabels(text: string): any {\n  const byHref: any = {};\n  const byOldId: any = {};\n\n  forEach(findLabels(text), (label) => {\n    const alreadyAdded = byHref[label.href];\n    const current = extend({}, label);\n\n    if (!alreadyAdded) {\n      byHref[current.href] = current;\n    } else if (hasTitle(current) && !hasTitle(alreadyAdded)) {\n      alreadyAdded.title = current.title;\n    }\n\n    byOldId[current.id] = alreadyAdded || current;\n  });\n\n  return {\n    byHref: byHref,\n    byOldId: byOldId,\n  };\n}\n\nexport function rewriteRefs(text: string) {\n  const merged = mergeLabels(text);\n  const hrefToRefId: any = {};\n  const labels: any[] = [];\n  const rewrites: any[] = [];\n  let i = 1;\n\n  // 1. compose list of labels with new ids, in order\n  forEach(findRefs(text), (ref) => {\n    const oldLabel = merged.byOldId[ref.id];\n    if (!oldLabel) {\n      return;\n    }\n    const href = oldLabel.href;\n    let newRefId = hrefToRefId[href];\n\n    if (!newRefId) {\n      hrefToRefId[href] = newRefId = i;\n      i += 1;\n      labels.push(extend({ newId: newRefId }, oldLabel));\n    }\n\n    // 1b. prepare rewrites to be applied, with new label ids\n    rewrites.push(extend({ newId: newRefId }, ref));\n  });\n\n  // 2. remove all labels!\n  forEach(findLabels(text), (label) => {\n    text = text.replace(label.match, '');\n  });\n\n  // 3. remove whitespace from the end of text\n  text = text.replace(/[\\r\\n\\s]*$/, '');\n  text += '\\n\\n';\n\n  // 4. apply rewrites\n  forEach(rewrites, (ref) => {\n    text = text.replace(ref.match, buildRef(ref, ref.newId));\n  });\n\n  // 5. print new labels at the end of text\n  forEach(labels, (label) => {\n    text += '\\n' + buildLabel(label, label.newId);\n  });\n\n  return text;\n}\n\n/**\n * Finding stuff\n */\n\nfunction makeFinder(type: 'inline' | 'ref' | 'label'): (text: string) => Array<any> {\n  return (text: string) => findAll(text, type).map(PROCESSORS[type] as any);\n}\n\nexport function findMaxLabelId(textOrLabels: any): number {\n  if (isString(textOrLabels)) {\n    textOrLabels = findLabels(textOrLabels);\n  }\n\n  const ids = textOrLabels\n    .map((x: any) => x.id)\n    .map((x: any) => parseInt(x, 10))\n    .filter((x: any) => isFinite(x) && x > 0);\n\n  return ids.length > 0 ? max(ids) || 0 : 0;\n}\n\nfunction findAll(text: string, type: 'inline' | 'ref' | 'label') {\n  const flags = 'g' + (type === 'label' ? 'm' : '');\n  const matches = [];\n  const re = new RegExp(REGEXS[type].source, flags);\n  let found = re.exec(text);\n\n  while (found) {\n    matches.push(found);\n    re.lastIndex = found.index + found[0].length;\n    found = re.exec(text);\n  }\n\n  return matches;\n}\n\n/**\n * Other utilities\n */\n\nfunction hasTitle(link: { title: string }) {\n  return isObject(link) && isString(link.title) && link.title.length > 0;\n}\n\nfunction buildLabel(link: { href: string; title: string }, id: number) {\n  let markup = '[' + id + ']: ' + link.href;\n  if (hasTitle(link)) {\n    markup += ' \"' + link.title + '\"';\n  }\n  return markup;\n}\n\nfunction buildRef(link: { text: string }, id: number) {\n  return '[' + link.text + '][' + id + ']';\n}\n","import { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { KnownSDK } from '@contentful/app-sdk';\nimport { openInsertLinkDialog } from './dialogs/InsertLinkModalDialog';\nimport { openInsertSpecialCharacter } from './dialogs/SpecialCharacterModalDialog';\nimport { openInsertTableDialog } from './dialogs/InsertTableModalDialog';\nimport { openEmbedExternalContentDialog } from './dialogs/EmdebExternalContentDialog';\nimport { openConfirmInsertAsset } from './dialogs/ConfirmInsertAssetModalDialog';\nimport { openZenMode } from './dialogs/ZenModeModalDialog';\nimport { insertAssetLinks } from './utils/insertAssetLinks';\nimport * as LinkOrganizer from './utils/linkOrganizer';\n\nexport function createMarkdownActions(props: {\n  sdk: KnownSDK;\n  editor: InitializedEditorType | null;\n  locale: string;\n}) {\n  const { sdk, editor, locale } = props;\n\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-types\n  const insertAssetsWithConfirmation = async (assets: Array<Object> | null) => {\n    if (assets) {\n      const { links, fallbacks } = await insertAssetLinks(assets, {\n        localeCode: locale,\n        defaultLocaleCode: sdk.locales.default,\n        fallbackCode: sdk.locales.fallbacks[locale],\n      });\n      if (links && links.length > 0) {\n        if (fallbacks) {\n          const insertAnyway = await openConfirmInsertAsset(sdk.dialogs, {\n            locale: locale,\n            assets: fallbacks,\n          });\n          if (!insertAnyway) {\n            throw Error('User decided to not use fallbacks');\n          }\n        }\n        return links.map((link) => link.asMarkdown).join('\\n\\n');\n      }\n    }\n    return '';\n  };\n\n  return {\n    headings: {\n      h1: () => {\n        editor?.actions.h1();\n      },\n      h2: () => {\n        editor?.actions.h2();\n      },\n      h3: () => {\n        editor?.actions.h3();\n      },\n    },\n    simple: {\n      italic: () => {\n        editor?.actions.italic();\n      },\n      bold: () => {\n        editor?.actions.bold();\n      },\n      quote: () => {\n        editor?.actions.quote();\n      },\n      ol: () => {\n        editor?.actions.ol();\n      },\n      ul: () => {\n        editor?.actions.ul();\n      },\n      strike: () => {\n        editor?.actions.strike();\n      },\n      code: () => {\n        editor?.actions.code();\n      },\n      hr: () => {\n        editor?.actions.hr();\n      },\n      indent: () => {\n        editor?.actions.indent();\n      },\n      dedent: () => {\n        editor?.actions.dedent();\n      },\n    },\n    history: {\n      undo: () => {\n        editor?.actions.undo();\n      },\n      redo: () => {\n        editor?.actions.redo();\n      },\n    },\n    insertLink: async () => {\n      if (!editor) {\n        return;\n      }\n      editor.usePrimarySelection();\n      const selectedText = editor.getSelectedText();\n      const result = await openInsertLinkDialog(sdk.dialogs, { selectedText });\n      if (result) {\n        editor.actions.link(result.url, selectedText || result.text, result.title);\n      }\n    },\n    insertSpecialCharacter: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertSpecialCharacter(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    insertTable: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertTableDialog(sdk.dialogs);\n      if (result) {\n        editor.actions.table(result);\n      }\n    },\n    organizeLinks: () => {\n      if (!editor) {\n        return;\n      }\n      let text = editor.getContent();\n      if (!text) {\n        return;\n      }\n      text = LinkOrganizer.convertInlineToRef(text);\n      text = LinkOrganizer.rewriteRefs(text);\n      editor.setContent(text);\n      sdk.notifier.success('All your links are now references at the bottom of your document.');\n    },\n    embedExternalContent: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openEmbedExternalContentDialog(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    addNewMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const { entity: asset } = (await sdk.navigator.openNewAsset({\n          slideIn: { waitForClose: true },\n        })) as any; // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n\n        const markdownLinks = await insertAssetsWithConfirmation([asset]);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    linkExistingMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const assets = await sdk.dialogs.selectMultipleAssets({\n          locale: locale,\n        });\n        const markdownLinks = await insertAssetsWithConfirmation(assets);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    openZenMode: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openZenMode(sdk.dialogs, {\n        initialValue: editor.getContent(),\n        locale: props.locale,\n      });\n\n      editor.setContent(result.value);\n\n      if (result.cursor) {\n        editor.setCursor(result.cursor);\n      }\n\n      editor.focus();\n    },\n    closeZenMode: () => {\n      // do nothing\n      // this method is overwritten in dialog app\n    },\n  };\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownTabs } from './components/MarkdownTabs';\nimport { MarkdownToolbar } from './components/MarkdownToolbar';\nimport { MarkdownTextarea } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownBottomBar, MarkdownHelp } from './components/MarkdownBottomBar';\nimport { MarkdownTab, PreviewComponents } from './types';\nimport { openCheatsheetModal } from './dialogs/CheatsheetModalDialog';\nimport { MarkdownPreview } from './components/MarkdownPreview';\nimport { MarkdownConstraints } from './components/MarkdownConstraints';\nimport { createMarkdownActions } from './MarkdownActions';\n\nconst styles = {\n  container: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontFamily: tokens.fontStackPrimary,\n  }),\n};\n\nexport interface MarkdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * Minimum height to set for the markdown text area and preview\n   */\n  minHeight?: string | number;\n\n  sdk: FieldExtensionSDK;\n\n  previewComponents?: PreviewComponents;\n  onReady?: Function;\n}\n\nexport function MarkdownEditor(\n  props: MarkdownEditorProps & {\n    disabled: boolean;\n    initialValue: string | null | undefined;\n    saveValueToSDK: Function;\n  }\n) {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [selectedTab, setSelectedTab] = React.useState<MarkdownTab>('editor');\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n  const [canUploadAssets, setCanUploadAssets] = React.useState<boolean>(false);\n\n  React.useEffect(() => {\n    if (editor && props.onReady) {\n      props.onReady(editor);\n      // fix: http://codemirror.977696.n3.nabble.com/codemirror-content-not-visible-in-bootstrap-modal-td4026988.html\n      setTimeout(() => {\n        editor.refresh();\n      }, 1);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  React.useEffect(() => {\n    props.sdk.access.can('create', 'Asset').then((value) => {\n      setCanUploadAssets(value);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  React.useEffect(() => {\n    if (editor) {\n      editor.setReadOnly(props.disabled);\n    }\n  }, [editor, props.disabled]);\n\n  const isActionDisabled = editor === null || props.disabled || selectedTab !== 'editor';\n\n  const direction = props.sdk.locales.direction[props.sdk.field.locale] ?? 'ltr';\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.sdk.field.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const openMarkdownHelp = React.useCallback(() => {\n    openCheatsheetModal(props.sdk.dialogs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  return (\n    <div className={styles.container} data-test-id=\"markdown-editor\">\n      <MarkdownTabs\n        active={selectedTab}\n        onSelect={(tab) => {\n          setSelectedTab(tab);\n        }}\n      />\n      <MarkdownToolbar\n        mode=\"default\"\n        disabled={isActionDisabled}\n        canUploadAssets={canUploadAssets}\n        actions={actions}\n      />\n      <MarkdownTextarea\n        minHeight={props.minHeight}\n        mode=\"default\"\n        visible={selectedTab === 'editor'}\n        disabled={isActionDisabled}\n        direction={direction}\n        onReady={(editor) => {\n          editor.setContent(props.initialValue ?? '');\n          editor.setReadOnly(props.disabled);\n          setEditor(editor);\n          editor.events.onChange((value: string) => {\n            // Trim empty lines\n            const trimmedValue = value.replace(/^\\s+$/gm, '');\n            props.saveValueToSDK(trimmedValue);\n            setCurrentValue(value);\n          });\n        }}\n      />\n      {selectedTab === 'preview' && (\n        <MarkdownPreview\n          direction={direction}\n          minHeight={props.minHeight}\n          mode=\"default\"\n          value={currentValue}\n          previewComponents={props.previewComponents}\n        />\n      )}\n      <MarkdownBottomBar>\n        <MarkdownHelp onClick={openMarkdownHelp} />\n      </MarkdownBottomBar>\n      <MarkdownConstraints sdk={props.sdk} value={currentValue} />\n    </div>\n  );\n}\n\nexport function MarkdownEditorConnected(props: MarkdownEditorProps) {\n  return (\n    <FieldConnector<string>\n      throttle={300}\n      field={props.sdk.field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, disabled, setValue, externalReset }) => {\n        // on external change reset component completely and init with initial value again\n        return (\n          <MarkdownEditor\n            {...props}\n            key={`markdown-editor-${externalReset}`}\n            initialValue={value}\n            disabled={disabled}\n            saveValueToSDK={setValue}\n          />\n        );\n      }}\n    </FieldConnector>\n  );\n}\n","import React from 'react';\nimport {\n  FieldExtensionSDK,\n  DialogExtensionSDK,\n  OpenCustomWidgetOptions,\n} from '@contentful/app-sdk';\nimport { ModalDialogLauncher } from '@contentful/field-editor-shared';\nimport { MarkdownDialogsParams, PreviewComponents } from '../types';\n\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { MarkdownDialogType } from '../types';\nimport { InsertLinkModal, InsertLinkModalResult } from './InsertLinkModalDialog';\nimport { InsertTableModal, InsertTableModalResult } from './InsertTableModalDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport {\n  EmbedExternalContentModal,\n  EmbedExternalContentModalResult,\n} from './EmdebExternalContentDialog';\nimport { ZenModeModalDialog, ZenModeResult } from './ZenModeModalDialog';\n\nexport const openMarkdownDialog =\n  (sdk: FieldExtensionSDK, previewComponents?: PreviewComponents) =>\n  (\n    options: OpenCustomWidgetOptions & {\n      parameters?: MarkdownDialogsParams;\n    }\n  ) => {\n    if (options.parameters?.type === MarkdownDialogType.cheatsheet) {\n      return ModalDialogLauncher.openDialog(options, () => {\n        return <CheatsheetModalDialog />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertLink) {\n      const selectedText = options.parameters.selectedText;\n      return ModalDialogLauncher.openDialog<InsertLinkModalResult>(options, ({ onClose }) => {\n        return <InsertLinkModal selectedText={selectedText} onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertSpecialCharacter) {\n      return ModalDialogLauncher.openDialog(options, ({ onClose }) => {\n        return <SpecialCharacterModalDialog onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertTable) {\n      return ModalDialogLauncher.openDialog<InsertTableModalResult>(options, ({ onClose }) => {\n        return <InsertTableModal onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.embedExternalContent) {\n      return ModalDialogLauncher.openDialog<EmbedExternalContentModalResult>(\n        options,\n        ({ onClose }) => {\n          return <EmbedExternalContentModal onClose={onClose} />;\n        }\n      );\n    } else if (options.parameters?.type === MarkdownDialogType.confirmInsertAsset) {\n      const locale = options.parameters.locale;\n      const assets = options.parameters.assets;\n      return ModalDialogLauncher.openDialog<boolean>(options, ({ onClose }) => {\n        return <ConfirmInsertAssetModalDialog onClose={onClose} locale={locale} assets={assets} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.zenMode) {\n      const initialValue = options.parameters.initialValue;\n      const locale = options.parameters.locale;\n      return ModalDialogLauncher.openDialog<ZenModeResult>(options, ({ onClose }) => {\n        return (\n          <ZenModeModalDialog\n            saveValueToSDK={(value) => {\n              if (value) {\n                return sdk?.field?.setValue(value);\n              }\n              return sdk?.field?.removeValue();\n            }}\n            onClose={onClose}\n            initialValue={initialValue}\n            locale={locale}\n            sdk={sdk as unknown as DialogExtensionSDK}\n            previewComponents={previewComponents}\n          />\n        );\n      });\n    }\n    return Promise.reject();\n  };\n","import React from 'react';\nimport { DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogsParams, MarkdownDialogType } from '../types';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { InsertLinkModal } from './InsertLinkModalDialog';\nimport { InsertTableModal } from './InsertTableModalDialog';\nimport { EmbedExternalContentModal } from './EmdebExternalContentDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport { ZenModeModalDialog } from './ZenModeModalDialog';\n\nexport const renderMarkdownDialog = (\n  sdk: DialogExtensionSDK & { parameters: { invocation: MarkdownDialogsParams } }\n) => {\n  const parameters = sdk.parameters.invocation;\n  if (parameters.type === MarkdownDialogType.cheatsheet) {\n    sdk.window.startAutoResizer();\n    return <CheatsheetModalDialog />;\n  } else if (parameters.type === MarkdownDialogType.insertLink) {\n    const selectedText = parameters.selectedText;\n    sdk.window.startAutoResizer();\n    return <InsertLinkModal selectedText={selectedText} onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertSpecialCharacter) {\n    sdk.window.startAutoResizer();\n    return <SpecialCharacterModalDialog onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertTable) {\n    sdk.window.startAutoResizer();\n    return <InsertTableModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.embedExternalContent) {\n    sdk.window.startAutoResizer();\n    return <EmbedExternalContentModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.confirmInsertAsset) {\n    const locale = parameters.locale;\n    const assets = parameters.assets;\n    sdk.window.startAutoResizer();\n    return <ConfirmInsertAssetModalDialog onClose={sdk.close} locale={locale} assets={assets} />;\n  } else if (parameters.type === MarkdownDialogType.zenMode) {\n    const locale = parameters.locale;\n    const initialValue = parameters.initialValue;\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    sdk.window.updateHeight('100%' as any);\n    return (\n      <ZenModeModalDialog\n        onClose={sdk.close}\n        saveValueToSDK={() => {\n          // don't save changes in dialog mode\n        }}\n        initialValue={initialValue}\n        locale={locale}\n        sdk={sdk}\n      />\n    );\n  }\n\n  return <div />;\n};\n"],"names":["styles","root","css","display","zIndex","flexDirection","justifyContent","overflow","marginBottom","fontSize","tokens","fontSizeM","tab","cursor","color","gray700","padding","spacingXs","minWidth","border","gray400","borderTopLeftRadius","borderRadiusSmall","borderTopRightRadius","marginLeft","textAlign","backgroundColor","gray100","borderBottomColor","outline","boxShadow","boxShadowHeavy","transition","transitionEasingDefault","transitionDurationShort","inactiveTab","background","gray200","gray300","MarkdownTabItem","props","React","className","cx","isActive","onClick","onSelect","name","onKeyDown","e","keyCode","tabIndex","role","testId","children","MarkdownTabs","active","srOnly","position","width","height","margin","clip","Zen","label","rest","viewBox","d","Strikethrough","Indent","Dedent","Cubes","Table","SpecialChar","OrgLinks","Undo","Redo","HeadingSelector","handleMenuClick","heading","Menu","Trigger","List","Item","InsertLinkSelector","canAddNew","MultipleMediaContextMenu","Button","isDisabled","disabled","startIcon","AssetIcon","size","variant","onSelectExisting","placement","endIcon","ChevronDownIcon","onAddNew","Number","zIndexWorkbenchHeader","button","spacing2Xs","marginRight","icon","fill","verticalAlign","zenButton","zenButtonPressed","tooltip","zIndexTooltip","ToolbarButton","forwardRef","ref","tooltipPlace","otherProps","Tooltip","content","IconButton","MainButtons","mode","actions","headings","HeadingIcon","simple","bold","FormatBoldIcon","italic","FormatItalicIcon","quote","QuoteIcon","ul","ListBulletedIcon","ol","ListNumberedIcon","insertLink","LinkIcon","AdditionalButtons","strike","Icons","code","CodeIcon","hr","HorizontalRuleIcon","indent","dedent","embedExternalContent","insertTable","insertSpecialCharacter","organizeLinks","history","undo","redo","DefaultMarkdownToolbar","useState","showAdditional","setShowAdditional","Flex","MoreHorizontalIcon","linkExistingMedia","addNewMedia","canUploadAssets","openZenMode","marginTop","ZenMarkdownToolbar","closeZenMode","displayName","MarkdownToolbar","memo","userAgent","get","window","platform","ctrlKey","getCtrlKey","stripUnit","value","match","Error","parseFloat","createPrefixToggleFn","prefix","editor","lineStartsWith","removeFromLineBeginning","length","insertAtLineBeginning","wrapSelection","marker","emptyText","usePrimarySelection","getSelection","selectedText","getSelectedText","startsWith","endsWith","markerLength","textWithoutMarker","slice","replaceSelectedText","insertAtCursor","selectBackwards","test","MSStream","quoteToggleFn","codeToggleFn","create","modifySelection","link","url","text","title","h1","toggleHeader","h2","h3","ulToggleFn","olToggleFn","cmd","moveIfNotEmpty","nl","getNl","getIndentation","indentation","table","config","line","getCurrentLineNumber","nrows","ncols","cellWidth","Array","cell","join","separatorCell","baseRow","separatorRow","times","bodyRows","range","map","replace","concat","tableTemplate","rows","cols","restoreCursor","toggleFn","isList","selection","cb","lines","anchor","head","maxNumber","max","minNumber","min","undefined","forEach","lineNumber","i","listNumber","moveToLineBeginning","forLineIn","moveToLineEnd","getListNumber","isCurrentLineEmpty","isLineEmpty","linesToInsert","getLinesCount","prepareListWhitespace","result","getCurrentLine","n","level","initialCh","getCurrentCharacter","currentHeader","header","select","getPos","modifier","ch","selectHeader","repeat","extendSelectionBy","removedCh","getSelectionLength","removeSelectedText","diff","lineHeightDefault","spacingL","fontStackMonospace","gray900","red600","gray600","blue500","framed","maxHeight","zen","maxWidth","MarkdownTextarea","hostRef","useRef","setEditor","useEffect","current","host","options","direction","fixedHeight","readOnly","initializedWithValue","EDITOR_SIZE","shift","cm","CodeMirror","lineNumbers","undoDepth","matchBrackets","lineWrapping","lineSeparator","theme","tabSize","indentWithTabs","indentUnit","autoRefresh","spellcheck","inputStyle","setSize","on","throttle","heightAtLine","lastLine","next","setOption","Tab","Enter","Esc","getInputField","blur","destroy","toTextArea","disable","enable","attachEvent","fn","throttleInterval","addKeyShortcuts","addKeyMap","transform","acc","key","setValue","getValue","clearHistory","getCurrentLineLength","focus","skip","len","selectAll","execCommand","prop","wrapper","replacement","replaceRange","charCount","replaceSelection","getCursor","setCursor","getLine","defaultToCurrentLineNumber","lineCount","getHistorySize","which","historySize","setReadOnly","getHistory","setHistory","setFullsize","refresh","character","noFocus","scroll","from","to","setSelection","selections","listSelections","somethingSelected","getOption","what","CodeMirrorWrapper","api","Commands","hasUndo","hasRedo","events","onScroll","onChange","wrapChange","onPaste","insert","getContent","setContent","clear","B","I","createMarkdownEditor","Object","assign","minHeight","onReady","style","visible","MarkdownDialogType","borderBottomLeftRadius","borderBottomRightRadius","spacingS","help","fontSizeS","lineHeight","MarkdownHelp","Paragraph","TextLink","as","MarkdownBottomBar","flexColumnContainer","flexWrap","flexColumn","flexGrow","verticalDivider","borderRight","gray500","paddingRight","spacing3Xl","spacing2Xl","preview","unOrderedListPreview","listStyleType","orderedListPreview","markup","paddingLeft","fontSize2Xl","fontSizeXl","fontSizeL","helpItem","alignItems","spacingXl","helpLink","flexRowContainer","CheatsheetModalDialog","ModalContent","Heading","href","target","rel","openCheatsheetModal","dialogs","openCurrent","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","parameters","type","cheatsheet","fontStackPrimary","spacingM","overflowY","rtl","MarkdownLink","Embedly","MarkdownPreview","cleanHTML","useMemo","DOMPurify","sanitize","Markdown","overrides","a","component","previewComponents","_props$previewCompone","embedly","MarkdownConstraints","constraints","ConstraintsUtils","fromFieldValidations","sdk","field","validations","checkConstraint","makeChecker","CharCounter","CharValidation","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","generator","Generator","context","Context","_invoke","state","method","arg","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","__await","then","unwrapped","error","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","urlRegex","isValidUrl","InsertLinkModal","onClose","mainInputRef","setText","setUrl","touched","setTouched","setTitle","onInsert","urlIsValid","_mainInputRef$current","Form","onSubmit","FormControl","id","Boolean","Label","TextInput","isInvalid","placeholder","maxLength","HelpText","ValidationMessage","ModalControls","specialCharacters","desc","buttonPanel","charButton","selectedCharButton","SpecialCharacterModalDialog","selectedCharacter","setSelectedCharacter","Text","String","fromCharCode","char","InsertTableModal","setRows","setColumns","rowsAreValid","inRange","colsAreValid","isRequired","toString","pattern","autoComplete","widthFiledGroup","radioButtonGroup","paddingTop","radioButton","isWidthValid","unit","EmbedExternalContentModal","selectedUnit","setUnit","setUrlValidity","setWidth","attachSocial","setAttachSocial","Radio","isChecked","Checkbox","fontColor","percent","px","makeEmbedlyLink","ConfirmInsertAssetModalDialog","assets","locale","localesNumber","EntityList","thumbnailUrl","thumbnailAltText","description","left","right","top","bottom","topSplit","bottomSplit","editorSplit","overflowX","editorSplitFullscreen","previewSplit","separator","hideButton","showButton","borderRightWidth","ZenModeModalDialog","initialValue","currentValue","setCurrentValue","showPreview","setShowPreview","updateHeight","setTimeout","createMarkdownActions","locales","saveValueToSDK","ChevronRightIcon","ChevronLeftIcon","makeAssetLink","asset","localeCode","fallbackCode","defaultLocaleCode","localizedFile","fallbackFile","defaultFile","file","isObject","str","trim","normalizeWhiteSpace","removeExtension","fileName","fileUrl","assetDomainMap","images","downloads","videos","_","p1","replaceAssetDomain","isLocalized","isFallback","asMarkdown","insertAssetLinks","otherLocales","filter","linksWithMeta","fallbackAssets","fields","fallbacks","links","extractTitle","split","tail","segments","PROCESSORS","inline","REGEXS","findInline","makeFinder","findRefs","findLabels","matches","re","RegExp","source","found","exec","lastIndex","index","findAll","hasTitle","isString","buildLabel","buildRef","insertAssetsWithConfirmation","confirmInsertAsset","merged","byHref","byOldId","alreadyAdded","extend","mergeLabels","hrefToRefId","labels","rewrites","oldLabel","newRefId","newId","LinkOrganizer","textOrLabels","ids","x","parseInt","isFinite","findMaxLabelId","notifier","success","navigator","openNewAsset","slideIn","waitForClose","entity","selectMultipleAssets","zenMode","container","fontFamily","MarkdownEditor","selectedTab","setSelectedTab","setCanUploadAssets","access","can","isActionDisabled","openMarkdownHelp","useCallback","trimmedValue","FieldConnector","isInitiallyDisabled","externalReset","ModalDialogLauncher","openDialog","_sdk$field","_sdk$field2","removeValue","invocation","startAutoResizer","close"],"mappings":"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"}