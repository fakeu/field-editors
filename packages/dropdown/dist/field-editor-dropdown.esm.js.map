{"version":3,"file":"field-editor-dropdown.esm.js","sources":["../src/dropdownUtils.ts","../src/styles.ts","../src/DropdownEditor.tsx"],"sourcesContent":["import { nanoid } from 'nanoid';\nimport { FieldAPI } from '@contentful/field-editor-shared';\n\ntype DropdownOption = {\n  id: string;\n  value: string | number | undefined;\n  label: string;\n};\n\nexport function parseValue(value: string, fieldType: string): string | number | undefined {\n  if (value === '') {\n    return undefined;\n  }\n  if (fieldType === 'Integer' || fieldType === 'Number') {\n    const asNumber = Number(value);\n    return isNaN(asNumber) ? undefined : asNumber;\n  }\n  return value;\n}\n\nexport function getOptions(field: FieldAPI): DropdownOption[] {\n  // Get first object that has a 'in' property\n  const validations = field.validations || [];\n  const predefinedValues = validations\n    .filter((validation) => (validation as any).in)\n    .map((validation) => (validation as any).in);\n\n  const firstPredefinedValues = predefinedValues.length > 0 ? predefinedValues[0] : [];\n\n  return firstPredefinedValues\n    .map((value: string) => ({\n      id: nanoid(6),\n      value: parseValue(value, field.type),\n      label: String(value),\n    }))\n    .filter((item: { value: string | number | undefined; label: string }) => {\n      return item.value !== undefined;\n    });\n}\n","import { css } from 'emotion';\n\nexport const rightToLeft = css({\n  direction: 'rtl',\n});\n","import * as React from 'react';\nimport {\n  FieldAPI,\n  FieldConnector,\n  PredefinedValuesError,\n  LocalesAPI,\n} from '@contentful/field-editor-shared';\nimport { getOptions, parseValue } from './dropdownUtils';\nimport * as styles from './styles';\n\nimport { Select } from '@contentful/f36-components';\n\nexport interface DropdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * sdk.field\n   */\n  field: FieldAPI;\n\n  /**\n   * sdk.locales\n   */\n  locales: LocalesAPI;\n}\n\nexport function DropdownEditor(props: DropdownEditorProps) {\n  const { field, locales } = props;\n\n  const options = getOptions(field);\n  const misconfigured = options.length === 0;\n\n  if (misconfigured) {\n    return <PredefinedValuesError />;\n  }\n\n  const direction = locales.direction[field.locale] || 'ltr';\n\n  return (\n    <FieldConnector<string | number>\n      throttle={0}\n      field={field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, errors, disabled, setValue }) => (\n        <Select\n          testId=\"dropdown-editor\"\n          isInvalid={errors.length > 0}\n          isDisabled={disabled}\n          className={direction === 'rtl' ? styles.rightToLeft : ''}\n          isRequired={field.required}\n          value={value === undefined ? '' : String(value)}\n          onChange={(e: React.ChangeEvent<HTMLSelectElement>) => {\n            const value = e.target.value;\n            setValue(parseValue(value, field.type));\n          }}>\n          <Select.Option value=\"\">Choose a value</Select.Option>\n          {options.map((option) => (\n            <Select.Option key={option.value} value={String(option.value)}>\n              {option.label}\n            </Select.Option>\n          ))}\n        </Select>\n      )}\n    </FieldConnector>\n  );\n}\n\nDropdownEditor.defaultProps = {\n  isInitiallyDisabled: true,\n};\n"],"names":["parseValue","value","fieldType","undefined","asNumber","Number","isNaN","getOptions","field","validations","predefinedValues","filter","validation","map","firstPredefinedValues","length","id","nanoid","type","label","String","item","rightToLeft","css","direction","DropdownEditor","props","locales","options","misconfigured","React","PredefinedValuesError","locale","FieldConnector","throttle","isInitiallyDisabled","errors","disabled","setValue","Select","testId","isInvalid","isDisabled","className","styles","isRequired","required","onChange","e","target","Option","option","key","defaultProps"],"mappings":"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"}