{"version":3,"file":"field-editor-rating.cjs.production.min.js","sources":["../src/RatingRibbon.tsx","../src/RatingEditor.tsx"],"sourcesContent":["import * as React from 'react';\nimport { css } from 'emotion';\n\nimport { IconButton } from '@contentful/f36-components';\n\nimport { StarIcon } from '@contentful/f36-icons';\n\ntype RatingRibbonProps = {\n  disabled: boolean;\n  stars: number;\n  value: number | null | undefined;\n  onSelect: (val: number) => void;\n};\n\ntype RatingRibbonState = {\n  hovered: null | number;\n};\n\nexport class RatingRibbon extends React.Component<RatingRibbonProps, RatingRibbonState> {\n  state = {\n    hovered: null,\n  };\n\n  isSelected = (num: number) => {\n    const hovered = this.state.hovered;\n    const value = this.props.value;\n\n    if (hovered !== null) {\n      return num <= hovered;\n    }\n    if (value) {\n      return num <= value;\n    }\n    return false;\n  };\n\n  onBlur = () => {\n    if (!this.props.disabled) {\n      this.setState({ hovered: null });\n    }\n  };\n\n  onFocus = (num: number) => () => {\n    if (!this.props.disabled) {\n      this.setState({ hovered: num });\n    }\n  };\n\n  render() {\n    const items: number[] = [];\n    for (let i = 1; i <= this.props.stars; i++) {\n      items.push(i);\n    }\n\n    return (\n      <>\n        {items.map((num) => (\n          <IconButton\n            variant=\"transparent\"\n            size=\"small\"\n            icon={\n              <StarIcon\n                variant={this.isSelected(num) ? 'primary' : 'muted'}\n                className={css({ width: '22px', height: '22px' })}\n              />\n            }\n            data-selected={this.isSelected(num) ? 'true' : 'false'}\n            testId=\"rating-editor-star\"\n            isDisabled={this.props.disabled}\n            key={num}\n            onClick={() => {\n              this.props.onSelect(num);\n            }}\n            onKeyDown={(e: React.KeyboardEvent) => {\n              if (e.keyCode === 13) {\n                this.props.onSelect(num);\n              }\n            }}\n            onMouseOver={this.onFocus(num)}\n            onMouseLeave={this.onBlur}\n            onFocus={this.onFocus(num)}\n            onBlur={this.onBlur}\n            aria-label={num.toString()}\n          />\n        ))}\n      </>\n    );\n  }\n}\n","import * as React from 'react';\nimport get from 'lodash/get';\nimport { FieldAPI, ParametersAPI, FieldConnector } from '@contentful/field-editor-shared';\nimport { RatingRibbon } from './RatingRibbon';\n\nimport { TextLink, Flex } from '@contentful/f36-components';\n\nexport interface RatingEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n\n  /**\n   * sdk.field\n   */\n  field: FieldAPI;\n\n  /**\n   * sdk.parameters\n   */\n  parameters?: ParametersAPI & {\n    instance: {\n      stars?: number;\n    };\n  };\n}\n\nfunction isValidCount(count?: string | number): count is number {\n  return typeof count === 'number' && !isNaN(count) && count > 0;\n}\n\nfunction getStarCount(count?: number | string): number {\n  const defaultValue = 5;\n\n  if (isValidCount(count)) {\n    return Math.round(count);\n  } else if (typeof count === 'string') {\n    const parsed = parseInt(count, 10);\n    return isValidCount(parsed) ? Math.round(parsed) : defaultValue;\n  } else {\n    return defaultValue;\n  }\n}\n\nexport function RatingEditor(props: RatingEditorProps) {\n  const { field } = props;\n\n  const starsCount = getStarCount(get(props.parameters, ['instance', 'stars']));\n\n  return (\n    <FieldConnector<number>\n      throttle={0}\n      field={field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ disabled, value, setValue }) => {\n        const clearOption = () => {\n          setValue(null);\n        };\n\n        return (\n          <Flex testId=\"rating-editor\" flexDirection=\"row\" marginTop=\"spacingS\">\n            <RatingRibbon\n              disabled={disabled}\n              value={value}\n              stars={starsCount}\n              onSelect={(num) => {\n                setValue(num);\n              }}\n            />\n            {value !== undefined && !disabled && (\n              <Flex marginLeft=\"spacingM\">\n                <TextLink as=\"button\" testId=\"rating-editor-clear\" onClick={clearOption}>\n                  Clear\n                </TextLink>\n              </Flex>\n            )}\n          </Flex>\n        );\n      }}\n    </FieldConnector>\n  );\n}\n\nRatingEditor.defaultProps = {\n  isInitiallyDisabled: true,\n};\n"],"names":["RatingRibbon","state","hovered","isSelected","num","_this","value","props","onBlur","disabled","setState","onFocus","render","items","i","this","stars","push","React","map","IconButton","variant","size","icon","StarIcon","_this2","className","css","width","height","testId","isDisabled","key","onClick","onSelect","onKeyDown","e","keyCode","onMouseOver","onMouseLeave","toString","isValidCount","count","isNaN","RatingEditor","field","starsCount","Math","round","parsed","parseInt","getStarCount","get","parameters","FieldConnector","throttle","isInitiallyDisabled","setValue","Flex","flexDirection","marginTop","undefined","marginLeft","TextLink","as","defaultProps"],"mappings":"qZAkBaA,8JACXC,MAAQ,CACNC,QAAS,QAGXC,WAAa,SAACC,OACNF,EAAUG,EAAKJ,MAAMC,QACrBI,EAAQD,EAAKE,MAAMD,aAET,OAAZJ,EACKE,GAAOF,IAEZI,GACKF,GAAOE,KAKlBE,OAAS,WACFH,EAAKE,MAAME,YACTC,SAAS,CAAER,QAAS,UAI7BS,QAAU,SAACP,UAAgB,WACpBC,EAAKE,MAAME,YACTC,SAAS,CAAER,QAASE,2GAI7BQ,OAAA,0BACQC,EAAkB,GACfC,EAAI,EAAGA,GAAKC,KAAKR,MAAMS,MAAOF,IACrCD,EAAMI,KAAKH,UAIXI,gCACGL,EAAMM,KAAI,SAACf,UACVc,gBAACE,cACCC,QAAQ,cACRC,KAAK,QACLC,KACEL,gBAACM,YACCH,QAASI,EAAKtB,WAAWC,GAAO,UAAY,QAC5CsB,UAAWC,MAAI,CAAEC,MAAO,OAAQC,OAAQ,2BAG7BJ,EAAKtB,WAAWC,GAAO,OAAS,QAC/C0B,OAAO,qBACPC,WAAYN,EAAKlB,MAAME,SACvBuB,IAAK5B,EACL6B,QAAS,WACPR,EAAKlB,MAAM2B,SAAS9B,IAEtB+B,UAAW,SAACC,GACQ,KAAdA,EAAEC,SACJZ,EAAKlB,MAAM2B,SAAS9B,IAGxBkC,YAAab,EAAKd,QAAQP,GAC1BmC,aAAcd,EAAKjB,OACnBG,QAASc,EAAKd,QAAQP,GACtBI,OAAQiB,EAAKjB,oBACDJ,EAAIoC,qBAhEMtB,aCUlC,SAASuB,EAAaC,SACI,iBAAVA,IAAuBC,MAAMD,IAAUA,EAAQ,WAgB/CE,EAAarC,OACnBsC,EAAUtC,EAAVsC,MAEFC,EAhBR,SAAsBJ,MAGhBD,EAAaC,UACRK,KAAKC,MAAMN,GACb,GAAqB,iBAAVA,EAAoB,KAC9BO,EAASC,SAASR,EAAO,WACxBD,EAAaQ,GAAUF,KAAKC,MAAMC,GANtB,SAAA,EAeFE,CAAaC,EAAI7C,EAAM8C,WAAY,CAAC,WAAY,kBAGjEnC,gBAACoC,kBACCC,SAAU,EACVV,MAAOA,EACPW,oBAAqBjD,EAAMiD,sBAC1B,gBAAG/C,IAAAA,SAAUH,IAAAA,MAAOmD,IAAAA,gBAMjBvC,gBAACwC,QAAK5B,OAAO,gBAAgB6B,cAAc,MAAMC,UAAU,YACzD1C,gBAAClB,GACCS,SAAUA,EACVH,MAAOA,EACPU,MAAO8B,EACPZ,SAAU,SAAC9B,GACTqD,EAASrD,WAGFyD,IAAVvD,IAAwBG,GACvBS,gBAACwC,QAAKI,WAAW,YACf5C,gBAAC6C,YAASC,GAAG,SAASlC,OAAO,sBAAsBG,QAhBvC,WAClBwB,EAAS,sBA2BnBb,EAAaqB,aAAe,CAC1BT,qBAAqB"}